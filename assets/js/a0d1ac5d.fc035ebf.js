"use strict";(self.webpackChunkopenmetal_docs=self.webpackChunkopenmetal_docs||[]).push([[8492],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return h}});var o=n(7294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)n=r[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=o.createContext({}),p=function(e){var t=o.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=p(e.components);return o.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},d=o.forwardRef((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),d=p(n),h=a,m=d["".concat(s,".").concat(h)]||d[h]||u[h]||r;return n?o.createElement(m,i(i({ref:t},c),{},{components:n})):o.createElement(m,i({ref:t},c))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,i=new Array(r);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var p=2;p<r;p++)i[p]=n[p];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}d.displayName="MDXCreateElement"},2932:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return p},toc:function(){return c},default:function(){return d}});var o=n(7462),a=n(3366),r=(n(7294),n(3905)),i=["components"],l={},s="Introduction to Ceph",p={unversionedId:"operators-manual/day-2/introduction-to-ceph",id:"operators-manual/day-2/introduction-to-ceph",title:"Introduction to Ceph",description:"Introduction",source:"@site/docs/operators-manual/day-2/introduction-to-ceph.md",sourceDirName:"operators-manual/day-2",slug:"/operators-manual/day-2/introduction-to-ceph",permalink:"/openmetal-docs/docs/operators-manual/day-2/introduction-to-ceph",editUrl:"https://github.com/openmetalio/openmetal-docs/blob/main/docs/operators-manual/day-2/introduction-to-ceph.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"How to Check Ceph's Status and Disk Usage",permalink:"/openmetal-docs/docs/operators-manual/day-2/check-ceph-status-disk-usage"},next:{title:"How to Live Migrate Instances Using OpenStack Horizon",permalink:"/openmetal-docs/docs/operators-manual/day-2/live-migrate-instances"}},c=[{value:"Introduction",id:"introduction",children:[],level:2},{value:"Table of Contents",id:"table-of-contents",children:[],level:2},{value:"Advantages of Ceph",id:"advantages-of-ceph",children:[{value:"Data Resiliency",id:"data-resiliency",children:[],level:3},{value:"Ceph Scales Extremely Well",id:"ceph-scales-extremely-well",children:[],level:3}],level:2},{value:"Disadvantages of Ceph",id:"disadvantages-of-ceph",children:[],level:2},{value:"Ceph Version Used by Private Clouds",id:"ceph-version-used-by-private-clouds",children:[],level:2},{value:"View Disk Usage of the Ceph Cluster",id:"view-disk-usage-of-the-ceph-cluster",children:[],level:2},{value:"Default Configuration for the Ceph Cluster",id:"default-configuration-for-the-ceph-cluster",children:[{value:"Default Ceph Pools",id:"default-ceph-pools",children:[{value:"Pool: images",id:"pool-images",children:[],level:4},{value:"Pool: volumes",id:"pool-volumes",children:[],level:4},{value:"Pool: vms",id:"pool-vms",children:[],level:4},{value:"Pool: backups",id:"pool-backups",children:[],level:4}],level:3}],level:2},{value:"Swift and Cinder Ceph Configuration",id:"swift-and-cinder-ceph-configuration",children:[],level:2},{value:"Reconfiguring your Ceph Cluster",id:"reconfiguring-your-ceph-cluster",children:[],level:2}],u={toc:c};function d(e){var t=e.components,n=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},u,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"introduction-to-ceph"},"Introduction to Ceph"),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"Ceph is an open-source, distributed storage system that provides object,\nblock and file storage interfaces from a single cluster. In this guide\nwe give a high-level overview of Ceph's services and how they are used\nin your OpenMetal Private Cloud."),(0,r.kt)("h2",{id:"table-of-contents"},"Table of Contents"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"introduction-to-ceph#advantages-of-ceph"},"Advantages of\nCeph")),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"introduction-to-ceph#data-resiliency"},"Data\nResiliency")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"introduction-to-ceph#ceph-scales-extremely-well"},"Ceph Scales Extremely\nWell")))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"introduction-to-ceph#disadvantages-of-ceph"},"Disadvantages of\nCeph"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"introduction-to-ceph#ceph-version-used-by-private-clouds"},"Ceph Version Used by Private\nClouds"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"introduction-to-ceph#view-disk-usage-of-the-ceph-cluster"},"View Disk Usage of the Ceph\nCluster"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"introduction-to-ceph#default-configuration-for-the-ceph-cluster"},"Default Configuration for the Ceph\nCluster")),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("ul",{parentName:"li"},(0,r.kt)("li",{parentName:"ul"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"introduction-to-ceph#default-ceph-pools"},"Default Ceph\nPools")),(0,r.kt)("ol",{parentName:"li"},(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"introduction-to-ceph#pool-images"},"Pool:\nimages")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"introduction-to-ceph#pool-volumes"},"Pool:\nvolumes")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"introduction-to-ceph#pool-vms"},"Pool:\nvms")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"introduction-to-ceph#pool-backups"},"Pool:\nbackups")))))))))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"introduction-to-ceph#swift-and-cinder-ceph-configuration"},"Swift and Cinder Ceph\nConfiguration"))),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("p",{parentName:"li"},(0,r.kt)("a",{parentName:"p",href:"introduction-to-ceph#reconfiguring-your-ceph-cluster"},"Reconfiguring your Ceph\nCluster")))),(0,r.kt)("h2",{id:"advantages-of-ceph"},"Advantages of Ceph"),(0,r.kt)("p",null,"See ",(0,r.kt)("a",{parentName:"p",href:"https://ceph.io/en/discover/benefits/"},"Ceph's Benefits page")," for a\nmore complete understanding of the benefits Ceph provides."),(0,r.kt)("h3",{id:"data-resiliency"},"Data Resiliency"),(0,r.kt)("p",null,"With Ceph, your data storage is resilient either through the use of\nreplication or erasure coding. In our configuration, replication is used\nto create multiple copies of data. Data is replicated at the host level.\nA Private Cloud is deployed with three hosts. With our Ceph\nconfiguration, you could lose two hosts and still have all of your Ceph\ncluster's data."),(0,r.kt)("h3",{id:"ceph-scales-extremely-well"},"Ceph Scales Extremely Well"),(0,r.kt)("p",null,"Ceph is designed to scale horizontally into Petabyte figures."),(0,r.kt)("h2",{id:"disadvantages-of-ceph"},"Disadvantages of Ceph"),(0,r.kt)("p",null,"Data access times are not as quick compared to accessing data directly\nfrom a disk. Should your workload require very fast disk reads and\nwrites, consider using a compute only node, where instances can be spun\nup on local, LVM-backed storage."),(0,r.kt)("p",null,"For more, see ",(0,r.kt)("a",{parentName:"p",href:"https://central.openmetal.io/documentation/operators-manual-extras/spin-up-an-instance-with-ephemeral-storage"},"Spin up an Instance with Ephemeral\nStorage"),"."),(0,r.kt)("h2",{id:"ceph-version-used-by-private-clouds"},"Ceph Version Used by Private Clouds"),(0,r.kt)("p",null,"With current Private Cloud deployments, Ceph's ",(0,r.kt)("a",{parentName:"p",href:"https://docs.ceph.com/en/latest/releases/octopus/"},"Octopus\nrelease")," is used."),(0,r.kt)("h2",{id:"view-disk-usage-of-the-ceph-cluster"},"View Disk Usage of the Ceph Cluster"),(0,r.kt)("p",null,"For more, see the guide on ",(0,r.kt)("a",{parentName:"p",href:"check-ceph-status-disk-usage"},"How to Check Ceph's Status and Disk\nUsage"),"."),(0,r.kt)("h2",{id:"default-configuration-for-the-ceph-cluster"},"Default Configuration for the Ceph Cluster"),(0,r.kt)("p",null,"Core Ceph services are deployed to each control plane node upon initial\ncloud deployment. This means each node comes installed with Ceph's\nMonitor, Manager, Object Gateway (RADOSGW), and Object Storage Daemon\n(OSD) services. Each node's secondary NVMe drive backs a Ceph OSD. Our\nCeph deployments are configured with host-level replication of data.\nYour cloud can lose all but one host and still retain all of the Ceph\ncluster's data."),(0,r.kt)("h3",{id:"default-ceph-pools"},"Default Ceph Pools"),(0,r.kt)("p",null,"By default, your Ceph cluster's data storage is logically divided into\npools, a concept associated with Ceph."),(0,r.kt)("p",null,"From a control plane node as root, we use ",(0,r.kt)("inlineCode",{parentName:"p"},"ceph osd lspools")," to list the\ndefault pools associated with a Private Cloud:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},"1 device_health_metrics\n2 images\n3 volumes\n4 vms\n5 backups\n6 metrics\n7 manila_data\n8 manila_metadata\n9 .rgw.root\n10 default.rgw.log\n11 default.rgw.control\n12 default.rgw.meta\n13 default.rgw.buckets.index\n")),(0,r.kt)("p",null,"Next, we explain the purpose of some of the Ceph pools."),(0,r.kt)("h4",{id:"pool-images"},"Pool: images"),(0,r.kt)("p",null,"Operating System images maintained by Glance are stored in this pool"),(0,r.kt)("h4",{id:"pool-volumes"},"Pool: volumes"),(0,r.kt)("p",null,"Cinder stores any volumes created by your cloud in this pool."),(0,r.kt)("h4",{id:"pool-vms"},"Pool: vms"),(0,r.kt)("p",null,"When you spin up a volume-backed instance, Nova is configured to create\na volume for that instance in this pool."),(0,r.kt)("h4",{id:"pool-backups"},"Pool: backups"),(0,r.kt)("p",null,"Cinder stores volume backups within this pool."),(0,r.kt)("h2",{id:"swift-and-cinder-ceph-configuration"},"Swift and Cinder Ceph Configuration"),(0,r.kt)("p",null,"With Private Clouds, Swift and Cinder are the services configured to\nconnect to Ceph."),(0,r.kt)("p",null,"Swift, OpenStack's Object Storage service, connects directly to the Ceph\ncluster. With our setup you will not see configuration for Swift in a\nplace like ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/kolla/swift"),". This configuration is instead handled by\nCeph directly and can be viewed through ",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/ceph/ceph.conf"),"."),(0,r.kt)("p",null,"Cinder, OpenStack's Block Storage service, is also configured to connect\nto Ceph. With Cinder, the are several services, of which ",(0,r.kt)("inlineCode",{parentName:"p"},"cinder-volume"),"\nand ",(0,r.kt)("inlineCode",{parentName:"p"},"cinder-backup")," are connected to Ceph. The Ceph configuration for\neach service can be viewed through\n",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/kolla/cinder-volume/cinder.conf")," and\n",(0,r.kt)("inlineCode",{parentName:"p"},"/etc/kolla/cinder-backup/cinder.conf"),"."),(0,r.kt)("h2",{id:"reconfiguring-your-ceph-cluster"},"Reconfiguring your Ceph Cluster"),(0,r.kt)("p",null,(0,r.kt)("strong",{parentName:"p"},"WARNING","!")," -- Our current deployment system deploys a Private Cloud\nwith a known working state. Should you deviate from this state by\nadjusting your cloud's Ceph configuration you can no longer safely use\nthe functions in OpenMetal Central to add nodes to your cloud or add IP\nblocks. Should you use these functions, any custom configurations to\nCeph will be reverted. We are working on rolling out a new deployment\nsystem allowing custom cloud configurations. We can still add new nodes\nand IP blocks to your cloud but must do so manually. Please reach out to\nyour Account Manager should this apply to you."),(0,r.kt)("p",null,"Your Ceph cluster was deployed using Ceph Ansible. Any configuration\nchanges must be made using Ceph Ansible. For more information, see ",(0,r.kt)("a",{parentName:"p",href:"../day-4/ceph-ansible"},"How\nto Prepare and Use Ceph\nAnsible"),"."))}d.isMDXComponent=!0}}]);