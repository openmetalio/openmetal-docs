"use strict";(self.webpackChunkopenmetal_docs=self.webpackChunkopenmetal_docs||[]).push([[5488],{3905:(e,t,n)=>{n.d(t,{Zo:()=>d,kt:()=>h});var r=n(67294);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},d=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},p="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,o=e.originalType,s=e.parentName,d=l(e,["components","mdxType","originalType","parentName"]),p=u(n),m=a,h=p["".concat(s,".").concat(m)]||p[m]||c[m]||o;return n?r.createElement(h,i(i({ref:t},d),{},{components:n})):r.createElement(h,i({ref:t},d))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:a,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},80358:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var r=n(87462),a=(n(67294),n(3905));const o={},i="Enabling Intel TDX on Bare Metal",l={unversionedId:"baremetal/tutorials/tdx-guide",id:"baremetal/tutorials/tdx-guide",title:"Enabling Intel TDX on Bare Metal",description:"Author: Nemanja Ilic",source:"@site/docs/baremetal/tutorials/tdx-guide.md",sourceDirName:"baremetal/tutorials",slug:"/baremetal/tutorials/tdx-guide",permalink:"/docs/manuals/baremetal/tutorials/tdx-guide",draft:!1,editUrl:"https://github.com/openmetalio/openmetal-docs/blob/main/docs/baremetal/tutorials/tdx-guide.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Securing a Proxmox VE Bare Metal Host",permalink:"/docs/manuals/baremetal/tutorials/securing-proxmox-node"},next:{title:"Create EC2 Credentials for Swift S3 API Access",permalink:"/docs/manuals/openstack-admin/access-swift-s3-api"}},s={},u=[{value:"Hardware Requirements",id:"hardware-requirements",level:2},{value:"CPU",id:"cpu",level:3},{value:"Memory",id:"memory",level:3},{value:"Before You Enter the BIOS: Identify Your Platform",id:"before-you-enter-the-bios-identify-your-platform",level:2},{value:"BIOS Configuration for TDX",id:"bios-configuration-for-tdx",level:2},{value:"Key Settings you&#39;ll enable",id:"key-settings-youll-enable",level:3},{value:"Verifying TDX After Boot",id:"verifying-tdx-after-boot",level:2},{value:"Conclusion",id:"conclusion",level:2}],d={toc:u};function p(e){let{components:t,...o}=e;return(0,a.kt)("wrapper",(0,r.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("h1",{id:"enabling-intel-tdx-on-bare-metal"},"Enabling Intel TDX on Bare Metal"),(0,a.kt)("p",null,"Author: Nemanja Ilic"),(0,a.kt)("p",null,(0,a.kt)("a",{parentName:"p",href:"https://openmetal.io/resources/hardware-details/intel-trust-domain-extensions-tdx/"},"Intel Trust Domain Extensions (TDX)"),"\nis part of Intel's confidential computing\nstack, and it's designed to give virtual machines a hardened boundary from the\nhost system. When TDX is enabled, workloads run inside encrypted,\nintegrity-protected \"Trust Domains\" that stay isolated even if the hypervisor\nor host OS is compromised. It's a big deal for customers handling sensitive or\nregulated workloads who don't want to rewrite applications just to get stronger\nisolation."),(0,a.kt)("p",null,"As interest grows, we've been getting the same question from users running on\nOpenMetal bare metal: ",(0,a.kt)("strong",{parentName:"p"},'"How do I actually enable TDX on my hardware?"')," The\nshort answer is: you need the right CPU, the right memory layout, and the right\nBIOS settings. Below is a walkthrough of what that looks like, based on the\nsystems we use. In order to access your hardware's BIOS, make sure you have\n",(0,a.kt)("a",{parentName:"p",href:"https://openmetal.io/docs/manuals/openmetal-central/ipmi-access"},"IPMI access")," first."),(0,a.kt)("admonition",{title:"Performance Benchmarks",type:"info"},(0,a.kt)("p",{parentName:"admonition"},"Want to see how Intel TDX performs on real bare metal workloads\n(including confidential blockchain and AI)? Check out the\n",(0,a.kt)("a",{parentName:"p",href:"https://openmetal.io/resources/blog/intel-tdx-performance-benchmarks-on-bare-metal-optimizing-confidential-blockchain-and-ai-workloads/"},"performance benchmarks blog post"),"\nfor data and insights.")),(0,a.kt)("h2",{id:"hardware-requirements"},"Hardware Requirements"),(0,a.kt)("p",null,"Before touching the BIOS,\n",(0,a.kt)("a",{parentName:"p",href:"https://openmetal.io/resources/blog/intel-tdx-and-sgx-requirements/"},"make sure the server can support TDX at all"),".\nIntel's requirements are not flexible here."),(0,a.kt)("h3",{id:"cpu"},"CPU"),(0,a.kt)("p",null,"Only specific modern Intel CPUs are TDX-capable. You'll need either:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"5th Gen Intel Xeon Scalable"),", or"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("strong",{parentName:"li"},"Intel Xeon 6"))),(0,a.kt)("p",null,"These processors include the architectural features and silicon extensions that\nmake TDX possible. See\n",(0,a.kt)("a",{parentName:"p",href:"https://cc-enabling.trustedservices.intel.com/intel-tdx-enabling-guide/03/hardware_selection/"},"Intel's TDX CPU documentation"),"."),(0,a.kt)("h3",{id:"memory"},"Memory"),(0,a.kt)("p",null,"TDX also requires a particular memory layout. For each CPU socket, ",(0,a.kt)("strong",{parentName:"p"},"all slot-0\nDIMM positions across every memory channel must be populated"),". In practice,\nthat means:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"At least 8 DIMMs per socket"),(0,a.kt)("li",{parentName:"ul"},"Symmetric configuration across channels")),(0,a.kt)("p",null,"If this condition isn't met, the firmware simply won't expose TDX. See\n",(0,a.kt)("a",{parentName:"p",href:"https://cc-enabling.trustedservices.intel.com/intel-tdx-enabling-guide/03/hardware_selection/#dimm-ie-main-memory-requirements"},"Intel's memory requirements documentation"),"."),(0,a.kt)("p",null,"Once CPU and memory check out, you can move on to BIOS configuration."),(0,a.kt)("h2",{id:"before-you-enter-the-bios-identify-your-platform"},"Before You Enter the BIOS: Identify Your Platform"),(0,a.kt)("p",null,"Intel groups TDX-capable systems into different platform families, and each of\nthose families exposes slightly different BIOS options. So before you start\nhunting through firmware menus, figure out exactly which CPU and platform your\nserver is running."),(0,a.kt)("p",null,"On Linux, just run ",(0,a.kt)("inlineCode",{parentName:"p"},"lscpu"),". This gives you the CPU model and microarchitecture\nso you can match your system to the correct section of Intel's TDX hardware\nsetup guide. For example,\n",(0,a.kt)("a",{parentName:"p",href:"https://openmetal.io/resources/media-and-press/openmetal-unveils-v4-hardware-catalog-for-superior-performance-across-applications/"},"many of our OpenMetal servers"),"\nuse the ",(0,a.kt)("strong",{parentName:"p"},"Intel Xeon\nGold 6530")," and based on\n",(0,a.kt)("a",{parentName:"p",href:"https://cc-enabling.trustedservices.intel.com/intel-tdx-enabling-guide/04/hardware_setup/"},"Intel's documentation"),",\nthis CPU falls under a\n",(0,a.kt)("strong",{parentName:"p"},"Beechnut City system with an Intel Xeon 6 processor"),", which determines which\nset of BIOS settings we must follow in the hardware enablement guide."),(0,a.kt)("h2",{id:"bios-configuration-for-tdx"},"BIOS Configuration for TDX"),(0,a.kt)("p",null,"Once you're in the BIOS, the exact layout depends on your platform, but the\nrequired settings are the same overall. Below is Intel's recommended\nconfiguration for a Beechnut City / Xeon 6 system:\n",(0,a.kt)("img",{alt:"TDX BIOS configuration diagram",src:n(19165).Z,width:"1426",height:"1244"})),(0,a.kt)("p",null,"Then in practice, on our hardware, the BIOS looks like this:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"TDX BIOS view-1",src:n(58959).Z,width:"1646",height:"1250"}),"\n",(0,a.kt)("img",{alt:"TDX BIOS view-1",src:n(98675).Z,width:"1678",height:"1260"})),(0,a.kt)("h3",{id:"key-settings-youll-enable"},"Key Settings you'll enable"),(0,a.kt)("table",null,(0,a.kt)("thead",{parentName:"table"},(0,a.kt)("tr",{parentName:"thead"},(0,a.kt)("th",{parentName:"tr",align:null},"Setting"),(0,a.kt)("th",{parentName:"tr",align:null},"Value"))),(0,a.kt)("tbody",{parentName:"table"},(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Memory Encryption (TME)"),(0,a.kt)("td",{parentName:"tr",align:null},"Enabled")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Total Memory Encryption (TME-MT)"),(0,a.kt)("td",{parentName:"tr",align:null},"Enabled")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Memory Integrity"),(0,a.kt)("td",{parentName:"tr",align:null},"Optional")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Trust Domain Extension (TDX)"),(0,a.kt)("td",{parentName:"tr",align:null},"Enabled")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"TDX Secure Arbitration Mode Loader (SEAM)"),(0,a.kt)("td",{parentName:"tr",align:null},"Enabled")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"TME-MT/TDX Key Split"),(0,a.kt)("td",{parentName:"tr",align:null},"Non-zero (we use 1)")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Software Guard Extensions (SGX)"),(0,a.kt)("td",{parentName:"tr",align:null},"Enabled")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"Limit CPU PA to 46 bits"),(0,a.kt)("td",{parentName:"tr",align:null},"Disabled")),(0,a.kt)("tr",{parentName:"tbody"},(0,a.kt)("td",{parentName:"tr",align:null},"PRM Size for SGX"),(0,a.kt)("td",{parentName:"tr",align:null},"Auto")))),(0,a.kt)("p",null,"That's the full set required for TDX enablement. Once saved and rebooted, your\nLinux environment should detect TDX support."),(0,a.kt)("h2",{id:"verifying-tdx-after-boot"},"Verifying TDX After Boot"),(0,a.kt)("p",null,"After BIOS configuration, once you're back in terminal, run:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-bash"},"lscpu | grep tdx\n")),(0,a.kt)("p",null,"If Intel TDX is enabled in firmware and supported by both the CPU and the\nrunning kernel, you should see TDX-related CPU flags exposed via ",(0,a.kt)("strong",{parentName:"p"},"lscpu"),", as\nshown in the example below. If not, revisit your BIOS settings or confirm\nyou're running on a platform that supports TDX."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"TDX flag",src:n(59919).Z,width:"2872",height:"270"})),(0,a.kt)("p",null,"Now that you're all set, you can proceed with\n",(0,a.kt)("a",{parentName:"p",href:"https://cc-enabling.trustedservices.intel.com/intel-tdx-enabling-guide/04/hardware_setup/#deploy-specific-intel-tdx-module-version"},"adding the modules you need"),"."),(0,a.kt)("h2",{id:"conclusion"},"Conclusion"),(0,a.kt)("p",null,"Intel TDX adds a meaningful security boundary for virtualized workloads by\nprotecting memory and execution even in the presence of a compromised host or\nhypervisor. On bare metal, where firmware, hardware layout, and Linux\nconfiguration are fully under your control, TDX becomes practical rather than\ntheoretical. While it doesn't replace good OS hardening or application\nsecurity, it significantly raises the bar for isolation and is a strong option\nfor running sensitive workloads without changing how they're built or deployed."))}p.isMDXComponent=!0},58959:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/BIOS-1-0b91d3ab0c1b45e259c9a4f1dc049838.png"},98675:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/BIOS-2-2b504544ebe8f1f099cc6db619a25e7e.png"},59919:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/grep-tdx-c625a5ee5b2e046b2eaa155c8e794451.png"},19165:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/tdx-diagram-0f1f4f6eb5671adf5db3844654685ece.png"}}]);