"use strict";(self.webpackChunkopenmetal_docs=self.webpackChunkopenmetal_docs||[]).push([[3332],{3905:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>y});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),l=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},u=function(e){var t=l(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,u=c(e,["components","mdxType","originalType","parentName"]),p=l(n),m=r,y=p["".concat(s,".").concat(m)]||p[m]||d[m]||o;return n?a.createElement(y,i(i({ref:t},u),{},{components:n})):a.createElement(y,i({ref:t},u))}));function y(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var c={};for(var s in t)hasOwnProperty.call(t,s)&&(c[s]=t[s]);c.originalType=e,c[p]="string"==typeof e?e:r,i[1]=c;for(var l=2;l<o;l++)i[l]=n[l];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},7703:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>p,frontMatter:()=>o,metadata:()=>c,toc:()=>l});var a=n(7462),r=(n(7294),n(3905));const o={sidebar_position:6},i="Working with OpenStack Barbican",c={unversionedId:"tutorials/intro-to-barbican",id:"tutorials/intro-to-barbican",title:"Working with OpenStack Barbican",description:"Barbican is the OpenStack Key Manager service. It provides secure storage,",source:"@site/docs/tutorials/intro-to-barbican.md",sourceDirName:"tutorials",slug:"/tutorials/intro-to-barbican",permalink:"/docs/manuals/tutorials/intro-to-barbican",draft:!1,editUrl:"https://github.com/openmetalio/openmetal-docs/blob/main/docs/tutorials/intro-to-barbican.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6},sidebar:"tutorialSidebar",previous:{title:"Create a Site-to-Site VPN Connection with Endpoint Groups",permalink:"/docs/manuals/tutorials/create-site-to-site-vpn"},next:{title:"How to Install OpenStack Barbican on your OpenMetal Cloud",permalink:"/docs/manuals/tutorials/install-barbican"}},s={},l=[{value:"What can I do with a Secret Store?",id:"what-can-i-do-with-a-secret-store",level:2},{value:"Creator Keystone Role",id:"creator-keystone-role",level:2},{value:"Encrypted Volume Type",id:"encrypted-volume-type",level:2},{value:"Encrypted Volume",id:"encrypted-volume",level:3},{value:"Spin up a VM with Encrypted Volume",id:"spin-up-a-vm-with-encrypted-volume",level:2}],u={toc:l};function p(e){let{components:t,...o}=e;return(0,r.kt)("wrapper",(0,a.Z)({},u,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"working-with-openstack-barbican"},"Working with OpenStack Barbican"),(0,r.kt)("p",null,"Barbican is the OpenStack Key Manager service. It provides secure storage,\nprovisioning and management of secret data. This includes keying material such\nas Symmetric Keys, Asymmetric Keys, Certificates and raw binary data. In our\ndefault Cloud Core deployment, Cinder, Nova, and Octavia use Barbican to manage\nsecrets. In this guide, we demonstrate booting a VM with an encrypted volume."),(0,r.kt)("h2",{id:"what-can-i-do-with-a-secret-store"},"What can I do with a Secret Store?"),(0,r.kt)("p",null,"With Barbican configured the service can be utilized for a number of use cases."),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Image signature verification"),(0,r.kt)("li",{parentName:"ul"},"Disk and volume encryption"),(0,r.kt)("li",{parentName:"ul"},"SSL/TLS keypair storage"),(0,r.kt)("li",{parentName:"ul"},"Secure password storage")),(0,r.kt)("p",null,"See the ",(0,r.kt)("a",{parentName:"p",href:"https://docs.openstack.org/security-guide/secrets-management/secrets-management-use-cases.html"},"OpenStack Security\nGuide"),"\nfor additional information."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"If Barbican is not installed to your cloud, see our\n",(0,r.kt)("a",{parentName:"p",href:"/docs/manuals/tutorials/install-barbican"},"guide")," or ",(0,r.kt)("a",{parentName:"p",href:"/docs/manuals/operators-manual/day-1/intro-to-openmetal-private-cloud#how-to-submit-a-support-ticket"},"submit a support\nticket"),"\nfor installation.")),(0,r.kt)("h2",{id:"creator-keystone-role"},"Creator Keystone Role"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"creator")," Keystone role is required by non-admin users who wish to use\nBarbican to manage secrets. The ",(0,r.kt)("inlineCode",{parentName:"p"},"admin")," role is required to modify the roles of\na user."),(0,r.kt)("p",null,"Set the creator role using:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"openstack role add creator --user nick --project 966582d3de534089a36cc39a2e5d0ff9\n")),(0,r.kt)("p",null,"Alternatively, in Horizon, you can adjust the role for a user by navigating to\n",(0,r.kt)("strong",{parentName:"p"},"Identity -> Projects"),". ",(0,r.kt)("img",{alt:"image",src:n(1639).Z,width:"741",height:"265"})),(0,r.kt)("h2",{id:"encrypted-volume-type"},"Encrypted Volume Type"),(0,r.kt)("p",null,"You can create encrypted volumes with Cinder. Before creating an encrypted\nvolume, a new volume type in Cinder must be created. Create a new Encrypted\nVolume type using:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"openstack volume type create --encryption-provider luks --encryption-cipher aes-xts-plain64 --encryption-key-size 256 --encryption-control-location front-end encrypted\n")),(0,r.kt)("p",null,"Output:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n| Field       | Value                                                                                                                                         |\n+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n| description | None                                                                                                                                          |\n| encryption  | cipher='aes-xts-plain64', control_location='front-end', encryption_id='bd8cc91f-877a-4c13-a0b1-65b236f0c3c6', key_size='256', provider='luks' |\n| id          | 6677cb0d-b548-4eb5-b789-aadacfd6ec94                                                                                                          |\n| is_public   | True                                                                                                                                          |\n| name        | encrypted                                                                                                                                     |\n+-------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n")),(0,r.kt)("h3",{id:"encrypted-volume"},"Encrypted Volume"),(0,r.kt)("p",null,"Create an encrypted volume using:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"openstack volume create --size 10 --type encrypted --image 'Ubuntu 22.04 (Jammy)' --bootable ubuntu22\n")),(0,r.kt)("p",null,"Output:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"+---------------------+--------------------------------------+\n| Field               | Value                                |\n+---------------------+--------------------------------------+\n| attachments         | []                                   |\n| availability_zone   | nova                                 |\n| bootable            | false                                |\n| consistencygroup_id | None                                 |\n| created_at          | 2023-10-05T19:37:09.563568           |\n| description         | None                                 |\n| encrypted           | True                                 |\n| id                  | dd4fc56c-d1f1-4700-add2-d06c0183dbe3 |\n| migration_status    | None                                 |\n| multiattach         | False                                |\n| name                | ubuntu22                             |\n| properties          |                                      |\n| replication_status  | None                                 |\n| size                | 10                                   |\n| snapshot_id         | None                                 |\n| source_volid        | None                                 |\n| status              | creating                             |\n| type                | encrypted                            |\n| updated_at          | None                                 |\n| user_id             | 2d1fd7d55b4f49f3b5bde488b6bc949f     |\n+---------------------+--------------------------------------+\n")),(0,r.kt)("h2",{id:"spin-up-a-vm-with-encrypted-volume"},"Spin up a VM with Encrypted Volume"),(0,r.kt)("p",null,"Using the encrypted volume created in the previous step, spin up a VM with it\nusing:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},'vol=dd4fc56c-d1f1-4700-add2-d06c0183dbe3\nopenstack server create --flavor gen.small --volume $vol --network External --security-group "SSH ingress" --key-name key ubuntu22_encrypted\n')),(0,r.kt)("p",null,"Output:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-sh"},"+-------------------------------------+---------------------------------------------+\n| Field                               | Value                                       |\n+-------------------------------------+---------------------------------------------+\n| OS-DCF:diskConfig                   | MANUAL                                      |\n| OS-EXT-AZ:availability_zone         |                                             |\n| OS-EXT-SRV-ATTR:host                | None                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                        |\n| OS-EXT-SRV-ATTR:instance_name       |                                             |\n| OS-EXT-STS:power_state              | NOSTATE                                     |\n| OS-EXT-STS:task_state               | scheduling                                  |\n| OS-EXT-STS:vm_state                 | building                                    |\n| OS-SRV-USG:launched_at              | None                                        |\n| OS-SRV-USG:terminated_at            | None                                        |\n| accessIPv4                          |                                             |\n| accessIPv6                          |                                             |\n| addresses                           |                                             |\n| adminPass                           | NWqPR38Qj48L                                |\n| config_drive                        |                                             |\n| created                             | 2023-10-05T19:45:51Z                        |\n| flavor                              | gen.small (gen.small)                       |\n| hostId                              |                                             |\n| id                                  | ea82e509-7efa-44a7-ba2b-e6364f458958        |\n| image                               | N/A (booted from volume)                    |\n| key_name                            | key                                         |\n| name                                | ubuntu22_encrypted                          |\n| progress                            | 0                                           |\n| project_id                          | 4993ac59480646b6b15ae7727279ca11            |\n| properties                          |                                             |\n| security_groups                     | name='6ffcdf91-d8dd-4499-98e1-0860267ea08e' |\n| status                              | BUILD                                       |\n| updated                             | 2023-10-05T19:45:51Z                        |\n| user_id                             | 2d1fd7d55b4f49f3b5bde488b6bc949f            |\n| volumes_attached                    |                                             |\n+-------------------------------------+---------------------------------------------+\n")))}p.isMDXComponent=!0},1639:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/manage-members-18b9495c678cedee59fce69dcb6009d4.jpg"}}]);