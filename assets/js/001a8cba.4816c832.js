"use strict";(self.webpackChunkopenmetal_docs=self.webpackChunkopenmetal_docs||[]).push([[6680],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>b});var r=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,p=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),u=s(n),h=o,b=u["".concat(p,".").concat(h)]||u[h]||d[h]||a;return n?r.createElement(b,i(i({ref:t},c),{},{components:n})):r.createElement(b,i({ref:t},c))}));function b(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=h;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[u]="string"==typeof e?e:o,i[1]=l;for(var s=2;s<a;s++)i[s]=n[s];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},68:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>l,toc:()=>s});var r=n(87462),o=(n(67294),n(3905));const a={},i="How to Prepare and Use Ceph Ansible",l={unversionedId:"day-4/ceph-ansible/prepare-ceph-ansible",id:"version-2.0/day-4/ceph-ansible/prepare-ceph-ansible",title:"How to Prepare and Use Ceph Ansible",description:"Introduction",source:"@site/operators_versioned_docs/version-2.0/day-4/ceph-ansible/prepare-ceph-ansible.md",sourceDirName:"day-4/ceph-ansible",slug:"/day-4/ceph-ansible/prepare-ceph-ansible",permalink:"/docs/manuals/operators-manual/operators_versioned_docs/version-2.0/day-4/ceph-ansible/prepare-ceph-ansible",draft:!1,editUrl:"https://github.com/openmetalio/openmetal-docs/blob/main/operators_versioned_docs/version-2.0/day-4/ceph-ansible/prepare-ceph-ansible.md",tags:[],version:"2.0",frontMatter:{},sidebar:"operatorsSidebar",previous:{title:"Security and Your OpenMetal Private Cloud",permalink:"/docs/manuals/operators-manual/operators_versioned_docs/version-2.0/day-4/security/security-best-practices"},next:{title:"OpenStack Watcher Demonstration",permalink:"/docs/manuals/operators-manual/operators_versioned_docs/version-2.0/day-4/watcher/watcher-demo"}},p={},s=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Root Access to OpenStack Control Plane",id:"root-access-to-openstack-control-plane",level:3},{value:"Path to the Ceph Configuration Files",id:"path-to-the-ceph-configuration-files",level:3},{value:"Preparation",id:"preparation",level:2},{value:"Add SSH key for Ceph Ansible",id:"add-ssh-key-for-ceph-ansible",level:3}],c={toc:s};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"how-to-prepare-and-use-ceph-ansible"},"How to Prepare and Use Ceph Ansible"),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"Should you want to reconfigure your Private Cloud's Ceph cluster, you\ncan do so using Ceph Ansible. In this guide, we explain how to prepare\nan environment from which Ceph Ansible can be used. Making specific\nconfiguration changes to your Ceph cluster is outside the scope of this\nguide."),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("h3",{id:"root-access-to-openstack-control-plane"},"Root Access to OpenStack Control Plane"),(0,o.kt)("p",null,"Root access to your cloud's control plane nodes is required."),(0,o.kt)("h3",{id:"path-to-the-ceph-configuration-files"},"Path to the Ceph Configuration Files"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Ceph Ansible Inventory: ",(0,o.kt)("inlineCode",{parentName:"li"},"/opt/ceph-ansible-cli/inventory.yml")),(0,o.kt)("li",{parentName:"ul"},"Ceph Ansible Config: ",(0,o.kt)("inlineCode",{parentName:"li"},"/opt/ceph-ansible-cli/group_vars/all.yml"))),(0,o.kt)("h2",{id:"preparation"},"Preparation"),(0,o.kt)("h3",{id:"add-ssh-key-for-ceph-ansible"},"Add SSH key for Ceph Ansible"),(0,o.kt)("p",null,"Before running Ceph Ansible, the deployment host must be able to connect over\nSSH to each of the inventory hosts."),(0,o.kt)("p",null,"Create an Ansible deployment SSH keypair with:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},'ssh-keygen -t ed25519 -C "ceph-ansible"\n')),(0,o.kt)("p",null,"Add the public key using OpenMetal Central under ",(0,o.kt)("strong",{parentName:"p"},"Settings -> Add SSH Key"),"."),(0,o.kt)("p",null,"To prepare Ceph Ansible:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"cd /opt/ceph-ansible-cli\nvirtualenv .venv\nsource .venv/bin/activate\npip install 'ansible-core<2.17,netaddr,setuptools,six'\n")),(0,o.kt)("p",null,"Deploy a Ceph Cluster:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"ansible-playbook \\\n    -i /opt/ceph-ansible-cli/inventory.yml \\\n    --private-key $CEPH_ANSIBLE_DEPLOY_KEY \\\n    /opt/ceph-ansible-cli/site.yml\n")),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"$CEPH_ANSIBLE_DEPLOY_KEY")," is the private SSH key created prior to running\n",(0,o.kt)("inlineCode",{parentName:"p"},"ansible-playbook"),". The public portion should exist on each of the deployment\nhosts."))}u.isMDXComponent=!0}}]);