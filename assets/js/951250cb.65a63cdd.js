"use strict";(self.webpackChunkopenmetal_docs=self.webpackChunkopenmetal_docs||[]).push([[8999],{3905:function(e,n,t){t.d(n,{Zo:function(){return u},kt:function(){return h}});var o=t(7294);function a(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function r(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,o)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?r(Object(t),!0).forEach((function(n){a(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):r(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,o,a=function(e,n){if(null==e)return{};var t,o,a={},r=Object.keys(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(o=0;o<r.length;o++)t=r[o],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var s=o.createContext({}),c=function(e){var n=o.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=c(e.components);return o.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return o.createElement(o.Fragment,{},n)}},p=o.forwardRef((function(e,n){var t=e.components,a=e.mdxType,r=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),p=c(t),h=a,f=p["".concat(s,".").concat(h)]||p[h]||d[h]||r;return t?o.createElement(f,i(i({ref:n},u),{},{components:t})):o.createElement(f,i({ref:n},u))}));function h(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var r=t.length,i=new Array(r);i[0]=p;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:a,i[1]=l;for(var c=2;c<r;c++)i[c]=t[c];return o.createElement.apply(null,i)}return o.createElement.apply(null,t)}p.displayName="MDXCreateElement"},7816:function(e,n,t){t.r(n),t.d(n,{frontMatter:function(){return l},contentTitle:function(){return s},metadata:function(){return c},toc:function(){return u},default:function(){return p}});var o=t(7462),a=t(3366),r=(t(7294),t(3905)),i=["components"],l={},s="How to Handle a Failed OpenStack Control Plane Node",c={unversionedId:"how-to-guides/recover-from-failed-control-plane-node",id:"how-to-guides/recover-from-failed-control-plane-node",title:"How to Handle a Failed OpenStack Control Plane Node",description:"\\[todo\\] revise",source:"@site/docs/how-to-guides/recover-from-failed-control-plane-node.md",sourceDirName:"how-to-guides",slug:"/how-to-guides/recover-from-failed-control-plane-node",permalink:"/openmetal-docs/docs/how-to-guides/recover-from-failed-control-plane-node",editUrl:"https://github.com/openmetalio/openmetal-docs/blob/main/docs/how-to-guides/recover-from-failed-control-plane-node.md",tags:[],version:"current",frontMatter:{},sidebar:"tutorialSidebar",previous:{title:"Recover an Instance Using Horizon",permalink:"/openmetal-docs/docs/how-to-guides/recoverinstance/recoveraninstance"}},u=[{value:"Introduction",id:"introduction",children:[],level:2},{value:"How do you know a Control Plane node has failed?",id:"how-do-you-know-a-control-plane-node-has-failed",children:[],level:2},{value:"How do you replace a Control Plane node?",id:"how-do-you-replace-a-control-plane-node",children:[],level:2},{value:"Ceph Storage and Instance Recovery",id:"ceph-storage-and-instance-recovery",children:[],level:2},{value:"Evacuate Instances",id:"evacuate-instances",children:[{value:"Prerequisites",id:"prerequisites",children:[],level:3}],level:2},{value:"Conclusion",id:"conclusion",children:[],level:2}],d={toc:u};function p(e){var n=e.components,t=(0,a.Z)(e,i);return(0,r.kt)("wrapper",(0,o.Z)({},d,t,{components:n,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"how-to-handle-a-failed-openstack-control-plane-node"},"How to Handle a Failed OpenStack Control Plane Node"),(0,r.kt)("p",null,"[","todo","]"," revise"),(0,r.kt)("h2",{id:"introduction"},"Introduction"),(0,r.kt)("p",null,"Private Cloud Core clouds come with three nodes comprising the core of\nthe cloud. These nodes are considered control plane nodes, because they\nrun all required OpenStack cloud services. In the event a control plane\nnode fails, how control plane node fails? What preparations can you make\nprior to a failure event? This guide explains what you can do to get\nyour cloud back up and running. In addition, preparations can be made to\nsoften the impact a failure like this could have."),(0,r.kt)("hr",null),(0,r.kt)("h2",{id:"how-do-you-know-a-control-plane-node-has-failed"},"How do you know a Control Plane node has failed?"),(0,r.kt)("p",null,"First, you should be sure you have a failed control plane situation. The\nnode or instances hosted on it may be inaccessible due to a variety of\nreasons. Perhaps Nova's compute service failed or something similar is\ngoing on. Contact our support via ",(0,r.kt)("a",{parentName:"p",href:"https://central.openmetal.io/"},"OpenMetal\nCentral")," to determine if the node\nactually needs to be replaced."),(0,r.kt)("h2",{id:"how-do-you-replace-a-control-plane-node"},"How do you replace a Control Plane node?"),(0,r.kt)("p",null,"There is no current self-service method for replacing a control plane\nnode. Our OpenMetal support staff will have to assist you with both\ndetermining what the failure is and in recovering cloud functionality by\nreplacing the failed node with a new one. Submit a ticket through\n",(0,r.kt)("a",{parentName:"p",href:"https://central.openmetal.io/"},"OpenMetal Central")," to have our agents\nlook into the issue."),(0,r.kt)("h2",{id:"ceph-storage-and-instance-recovery"},"Ceph Storage and Instance Recovery"),(0,r.kt)("p",null,"Regardless of if you're reading this and you have a failure on your\nhands or not, it is best to be prepared when it comes to how important\ndata is stored."),(0,r.kt)("p",null,"Understand that with the way we deployed Ceph to Private Cloud Core\nclouds, each control plane node is running a Ceph OSD daemon and each\nCeph pool is replicated three times, across each OSD. This means you\ncould lose one OSD, and still have your data replicated across the other\ntwo."),(0,r.kt)("p",null,"If your persistent instance data is stored in Ceph, then that data is\nreplicated across each control plane node. Losing a control plane node\nmeans any instances on that node will cease to function. However, if\nthose instances have their data stored within Ceph, then the data is not\nlost because Ceph's pools are replicated across each control plane node\nvia Ceph OSDs. There is a single Ceph OSD running per drive per control\nplane node. In this scenario, to recover instances, you can attempt to\nevacuate them to another node, should that node have enough resources."),(0,r.kt)("h2",{id:"evacuate-instances"},"Evacuate Instances"),(0,r.kt)("p",null,"If you are in a situation where you must get instances back online as\nsoon as possible, you can try evacuating them to another control plane\nnode. This section explains how to evacuate instances using Horizon."),(0,r.kt)("hr",null),(0,r.kt)("h3",{id:"prerequisites"},"Prerequisites"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"A Horizon account with the ",(0,r.kt)("strong",{parentName:"li"},"admin")," role")),(0,r.kt)("p",null,"To begin evacuating instances, log in to Horizon with a user that has\nthe ",(0,r.kt)("strong",{parentName:"p"},"admin"),' role. Typically you can use the "admin" account to\naccomplish this.'),(0,r.kt)("p",null,"Next, navigate to ",(0,r.kt)("strong",{parentName:"p"},"Admin -",">"," Compute -",">"," All Hypervisors")," to list\nhypervisors. From here, click the ",(0,r.kt)("strong",{parentName:"p"},"Compute Host")," tab to list this\ncloud's compute hosts."),(0,r.kt)("p",null,"To evacuate instances, you must first disable the compute services for\nthe affected host. To do so, find the ",(0,r.kt)("strong",{parentName:"p"},"Actions")," column to the right\nand click ",(0,r.kt)("strong",{parentName:"p"},"Disable Service"),". Upon doing this, a pop up appears\nallowing to enter a reason for disabling the service. Following that a\nnew drop down will appear allowing you to migrate the instances to a new\nhost called ",(0,r.kt)("strong",{parentName:"p"},"Migrate Host"),"."),(0,r.kt)("p",null,"Alternatively, if the compute service for the affected host is already\ndown, you will see a button to ",(0,r.kt)("strong",{parentName:"p"},"Evacuate Host")," under the ",(0,r.kt)("strong",{parentName:"p"},"Actions"),"\ncolumn on the right."),(0,r.kt)("h2",{id:"conclusion"},"Conclusion"),(0,r.kt)("p",null,"Should you think you have a failed control plane node, contact our\nOpenMetal support who will be able to determine if that is the case and\nalso help in restoring cloud functionality."))}p.isMDXComponent=!0}}]);