<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-213530121-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-213530121-1",{})</script>
<script src="/docs/manuals/js/fix-location.js"></script><title data-react-helmet="true">Building Windows Cloud Images on OpenMetal | OpenMetal Docs</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://openmetal.io/docs/manuals/engineers-notes/building-windows-cloud-images-on-openmetal"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" name="twitter:site" content="@openmetalio"><meta data-react-helmet="true" name="twitter:creator" content="@openmetalio"><meta data-react-helmet="true" property="og:title" content="Building Windows Cloud Images on OpenMetal | OpenMetal Docs"><meta data-react-helmet="true" name="description" content="Written by Yuriy Shyyan"><meta data-react-helmet="true" property="og:description" content="Written by Yuriy Shyyan"><link data-react-helmet="true" rel="icon" href="/docs/manuals/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://openmetal.io/docs/manuals/engineers-notes/building-windows-cloud-images-on-openmetal"><link data-react-helmet="true" rel="alternate" href="https://openmetal.io/docs/manuals/engineers-notes/building-windows-cloud-images-on-openmetal" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://openmetal.io/docs/manuals/engineers-notes/building-windows-cloud-images-on-openmetal" hreflang="x-default"><link rel="stylesheet" href="/docs/manuals/assets/css/styles.4e819631.css">
<link rel="preload" href="/docs/manuals/assets/js/runtime~main.e321a580.js" as="script">
<link rel="preload" href="/docs/manuals/assets/js/main.0b726748.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar"><div class="navbar__inner"><div class="navbar_top_row"><a href="https://openmetal.io/schedule-meeting/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">SCHEDULE MEETING</a><a href="https://openmetal.io/free-trial/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">FREE TRIAL</a><a href="https://central.openmetal.io/auth/sign-in" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">LOGIN</a></div><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://openmetal.io" target="_blank" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="https://inmotionhosting.github.io/static-assets/logo/open-metal/medium.png" alt="OpenMetal" class="themedImage_TMUO themedImage--light_4Vu1"><img src="https://inmotionhosting.github.io/static-assets/logo/open-metal/medium.png" alt="OpenMetal" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title"></b></a><div class="custom-navbar-item-dropdown"><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link" header="IAAS Products" target="_self">Products</a></div><div class="dropdown_menu_container"><ul class="dropdown__menu"><div class="dropdown_menu_left"><h2>IAAS Products</h2><div><li><a href="https://openmetal.io/products/private-cloud/hosted/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="The rich benefits of private cloud now delivered in 45 seconds" itemtype="link">On-Demand Private Cloud</a></li><p>The rich benefits of private cloud now delivered in 45 seconds</p></div><div><li><a href="https://openmetal.io/products/products/private-pods" target="_self" rel="noopener noreferrer" class="dropdown__link" description="The complete OpenMetal Platform in a data center of your choice" itemtype="link">Private Pods</a></li><p>The complete OpenMetal Platform in a data center of your choice</p></div></div><div class="dropdown_menu_right"><div><img class="img-responsive" src="https://openmetal.io/wp-content/uploads/2022/04/Large-IaaS-Deployments-Featured-Image-768x432.png"><li><a href="https://openmetal.io/products/products/private-pods" target="_self" rel="noopener noreferrer" class="dropdown__link" description="Leverage the on-demand fleet and team for innovative solutions" image_url="https://openmetal.io/wp-content/uploads/2022/04/Large-IaaS-Deployments-Featured-Image-768x432.png" itemtype="article">Large IAAS Deployments</a></li><p>Leverage the on-demand fleet and team for innovative solutions</p></div></div></ul></div></div><div class="custom-navbar-item-dropdown"><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link" header="IAAS Solutions" target="_self">Solutions</a></div><div class="dropdown_menu_container"><ul class="dropdown__menu"><div class="dropdown_menu_left"><h2>IAAS Solutions</h2><div><li><a href="https://openmetal.io/solutions/saas/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="Cost effective infrastructure is critical to good margins" itemtype="link">Private Cloud for SaaS</a></li><p>Cost effective infrastructure is critical to good margins</p></div><div><li><a href="https://openmetal.io/solutions/openstack-public-cloud-providers/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="Combined scale yields better costs, new locations, and more features" itemtype="link">OpenStack Public Cloud Providers</a></li><p>Combined scale yields better costs, new locations, and more features</p></div><div><li><a href="https://openmetal.io/solutions/it-modernization/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="Bring IT Modernization to your business" itemtype="link">IT Modernization</a></li><p>Bring IT Modernization to your business</p></div><div><li><a href="https://openmetal.io/solutions/on-demand-openstack/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="Harness the power of OpenStack to build private clouds at any size, on-demand" itemtype="link">On-Demand OpenStack</a></li><p>Harness the power of OpenStack to build private clouds at any size, on-demand</p></div></div><div class="dropdown_menu_right"><div><img class="img-responsive" src="https://openmetal.io/wp-content/uploads/2021/09/The-OpenMetal-Blog-6-768x432.png"><li><a href="https://openmetal.io/resources/blog/why-your-business-should-be-using-a-private-cloud/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="Moving Your Business to Private Cloud Companies are moving towards cloud adoption at record rates, yet there are still business owners ..." image_url="https://openmetal.io/wp-content/uploads/2021/09/The-OpenMetal-Blog-6-768x432.png" itemtype="article">Why Should your Business be Using a Private Cloud</a></li><p>Moving Your Business to Private Cloud Companies are moving towards cloud adoption at record rates, yet there are still business owners ...</p></div></div></ul></div></div><div class="custom-navbar-item-dropdown"><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link" header="Openmetal Platform" target="_self">Platform</a></div><div class="dropdown_menu_container"><ul class="dropdown__menu"><div class="dropdown_menu_left"><h2>Openmetal Platform</h2><div><li><a href="https://openmetal.io/platform/openstack-services/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">OpenStack Services</a></li><p></p></div><div><li><a href="https://openmetal.io/platform/features/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Features and Components</a></li><p></p></div><div><li><a href="https://openmetal.io/platform/locations/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Global Locations</a></li><p></p></div></div><div class="dropdown_menu_right"><div><img class="img-responsive" src="https://openmetal.io/wp-content/uploads/2021/09/The-OpenMetal-Blog-3-768x432.png"><li><a href="https://openmetal.io/resources/blog/move-from-public-cloud-to-private-cloud/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="Cloud Repatriation is the Choice of Cloud Professionals Public cloud users are finding out that for all their convenience and so-called ..." image_url="https://openmetal.io/wp-content/uploads/2021/09/The-OpenMetal-Blog-3-768x432.png" itemtype="article">Why Move from Public Cloud to Private Cloud</a></li><p>Cloud Repatriation is the Choice of Cloud Professionals Public cloud users are finding out that for all their convenience and so-called ...</p></div></div></ul></div></div><div class="custom-navbar-item-dropdown"><a href="https://openmetal.io/iaas-pricing/" target="_self" rel="noopener noreferrer" class="navbar__item navbar__link">Pricing</a></div><div class="custom-navbar-item-dropdown"><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link" header="Resources" target="_self">Resources</a></div><div class="dropdown_menu_container"><ul class="dropdown__menu"><div class="dropdown_menu_left"><h2>Resources</h2><div><li><a href="https://openmetal.io/resources/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">OpenMetal Blog</a></li><p></p></div><div><li><a href="https://openmetal.io/resources/cloud-industry-events/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Cloud Industry Events</a></li><p></p></div><div><li><a href="https://openmetal.io/resources/media-and-press/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Media &amp; Press</a></li><p></p></div><div><li><a href="https://openmetal.io/resources/sales-faq/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Sales FAQ</a></li><p></p></div><div><li><a href="https://central.openmetal.io/auth/sign-in" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Login to OpenMetal Central</a></li><p></p></div></div><div class="dropdown_menu_right"><div><img class="img-responsive" src="https://openmetal.io/wp-content/uploads/2021/08/The-OpenMetal-Blog-4-768x432.png"><li><a href="https://openmetal.io/resources/blog/public-cloud-vs-private-cloud-cost-tipping-points/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="It’s 2022, we know that a vast majority of organizations have adopted either a public cloud or private cloud. Within ..." image_url="https://openmetal.io/wp-content/uploads/2021/08/The-OpenMetal-Blog-4-768x432.png" itemtype="article">A Cost Tipping Point Guide for IT Professionals: Public vs Private Cloud</a></li><p>It’s 2022, we know that a vast majority of organizations have adopted either a public cloud or private cloud. Within ...</p></div></div></ul></div></div><div class="custom-navbar-item-dropdown"><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link" header="Documentation" target="_self">Docs</a></div><div class="dropdown_menu_container"><ul class="dropdown__menu"><div class="dropdown_menu_left"><h2>Documentation</h2><div><li><a href="https://openmetal.io/docs/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Documentation Home</a></li><p></p></div><div><li><a href="https://openmetal.io/docs/manuals/openstack-operators/openstack-operators-manual-private-cloud-core/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">OpenStack Operators Manual</a></li><p></p></div><div><li><a href="https://openmetal.io/docs/manuals/openstack-users/openstack-users-manual" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">OpenStack Users Manual</a></li><p></p></div><div><li><a href="https://openmetal.io/docs/product-guides/private-cloud/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Private Cloud Users</a></li><p></p></div><div><li><a href="https://openmetal.io/docs/releases/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Product Release Updates</a></li><p></p></div></div><div class="dropdown_menu_right"><div><img class="img-responsive" src="https://openmetal.io/wp-content/uploads/2022/03/Release-Update-768x403.png"><li><a href="https://openmetal.io/docs/releases/release-update-v1-4/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="OpenMetal Cloud Hardware Catalog Update – March 15th, 2022We are refreshing our catalog based on feedback and customization for customers ..." image_url="https://openmetal.io/wp-content/uploads/2022/03/Release-Update-768x403.png" itemtype="article">OMI Release V1.4: New XL-V2 Node Type Added</a></li><p>OpenMetal Cloud Hardware Catalog Update – March 15th, 2022We are refreshing our catalog based on feedback and customization for customers ...</p></div></div></ul></div></div><div class="custom-navbar-item-dropdown"><div class="navbar__item dropdown dropdown--hoverable"><a href="#" class="navbar__link" header="About Us" target="_self">Company</a></div><div class="dropdown_menu_container"><ul class="dropdown__menu"><div class="dropdown_menu_left"><h2>About Us</h2><div><li><a href="https://openmetal.io/company/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">About OpenMetal</a></li><p></p></div><div><li><a href="https://openmetal.io/company/guiding-principles/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Core Guiding Principles</a></li><p></p></div><div><li><a href="https://openmetal.io/company/contact-us/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="" itemtype="link">Contact Us</a></li><p></p></div></div><div class="dropdown_menu_right"><div><img class="img-responsive" src="https://openmetal.io/wp-content/uploads/2022/03/The-OpenMetal-Blog-7-1-768x432.png"><li><a href="https://openmetal.io/resources/blog/openmetal-and-supermicro-success-story/" target="_self" rel="noopener noreferrer" class="dropdown__link" description="Success Story: InMotion Hosting and Supermicro Join Forces Supermicro recently published a success story describing how InMotion Hosting built an on-demand private cloud ..." image_url="https://openmetal.io/wp-content/uploads/2022/03/The-OpenMetal-Blog-7-1-768x432.png" itemtype="article">Success Story: OpenStack On-Demand Private Clouds in Less than an Hour</a></li><p>Success Story: InMotion Hosting and Supermicro Join Forces Supermicro recently published a success story describing how InMotion Hosting built an on-demand private cloud ...</p></div></div></ul></div></div></div><div class="navbar__items navbar__items--right"></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/manuals/">Documentation Home</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/manuals/operators-manual/">Operator&#x27;s Manual</a><button aria-label="Toggle the collapsible sidebar category &#x27;Operator&#x27;s Manual&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/manuals/users-manual/">User&#x27;s Manual</a><button aria-label="Toggle the collapsible sidebar category &#x27;User&#x27;s Manual&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/docs/manuals/tutorials/">Tutorials</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active hasHref_TwRn" href="/docs/manuals/engineers-notes/building-windows-cloud-images-on-openmetal">Engineer&#x27;s Notes</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/manuals/engineers-notes/building-windows-cloud-images-on-openmetal">Building Windows Cloud Images on OpenMetal</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/manuals/kubernetes-guides/installing-an-openshift-cluster-on-openstack">Installing an OpenShift cluster on OpenStack</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Building Windows Cloud Images on OpenMetal</h1></header><p>Written by Yuriy Shyyan</p><p>Co-Authored by Sean Lafferty</p><p>This document is meant as a guide to utilizing an OpenMetal Private Cloud Core
to build various Windows Images for OpenStack on KVM with Virtio Storage drivers.</p><blockquote><p>The initial concept for this guide is to be able to bring nearly nothing and
come out with a Windows VM Image ready for cloud use.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="images-for-openstack">Images for OpenStack<a class="hash-link" href="#images-for-openstack" title="Direct link to heading">​</a></h2><p>In order to run a virtual machine on OpenStack, an Operating System image is
needed. These OS images are quite different from ISO images and are often a
point of confusion. While ISOs typically contain installation media and have
‘Live’ capabilities, VM images usually contain a snapshot of a fully installed
and configured Operating System that is copied to newly provisioned instances
with some slight post modification abilities via cloud deployment utilities
such as Cloudbase Init.</p><p>Many Linux Operating Systems provide cloud VM image snapshots that you can
download and upload for use on your cloud. OpenMetal provides a few of the
most recent and common Linux distribution images to newly provisioned OpenMetal
clouds. At time of writing Windows does not provide public OpenStack native
images so you must create one manually which can be customized for your needs.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="tools-required-for-this-guide">Tools required for this guide<a class="hash-link" href="#tools-required-for-this-guide" title="Direct link to heading">​</a></h2><p>For this guide the administrator will need the following:</p><ul><li><strong>OpenMetal Cloud</strong></li><li><strong>VNC Viewer</strong></li><li><strong>Windows ISO</strong> image with desired OS selections.</li><li><strong>RedHat Virtio Drivers ISO</strong></li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="openmetal-cloud">OpenMetal Cloud<a class="hash-link" href="#openmetal-cloud" title="Direct link to heading">​</a></h2><p>OpenMetal Private Cloud Core provides support for Nested Virtualization and
the networking needed in order to follow along with this guide, however any
OpenStack cloud with similar storage mechanics, nested virtualization enabled
and adequate network access can follow these directions.</p><blockquote><p>As an alternative you can use a local Console/VNC capable KVM hypervisor host
to create the Windows Instance Image.</p></blockquote><p>In our experience, Windows VM image building is best done on the platform on
which it will be used as disk conversion utilities rarely provide the desired
result. We have seen a lot of ‘No Boot Drive Found’ errors when dealing with
differing storage media.</p><blockquote><p><strong>Note: The drivers for network and storage type during installation are
required to match the storage in production</strong>.</p></blockquote><p><img alt="OpenMetal logo" src="data:image/png;base64,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"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="vnc-viewer">VNC Viewer<a class="hash-link" href="#vnc-viewer" title="Direct link to heading">​</a></h2><p>For the purposes of connecting to the nested instance to proceed with Windows
installation media we will need console access. This can be simulated using VNC.
We will be using <a href="https://www.realvnc.com/en/connect/download/viewer/" target="_blank" rel="noopener noreferrer">VNC Viewer by RealVNC</a>,
if you are familiar with other VNC software the underlying process remains the
same.</p><p><img alt="RealVNC logo" src="data:image/png;base64,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"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="windows-iso">Windows ISO<a class="hash-link" href="#windows-iso" title="Direct link to heading">​</a></h2><p>Several methods are available to obtain a Windows ISO image.</p><ul><li><p>Direct download</p></li><li><p>The Windows Media Creation tool</p><p> Generates a Windows ISO for specific distributions locally.</p></li><li><p>Azure Marketplace allows for image downloads with a sufficient account.</p></li></ul><p>Microsoft Offers a variety of Evaluation Images for testing that can later be
licensed.</p><blockquote><p>While outside the scope of this guide, community consensus indicates at
Evaluation trial expiration, the following behavior may be encountered:</p><ul><li>System may ask for activation and shut down often.</li><li>You may see Windows license expiration notice on a regular basis.</li></ul></blockquote><p>Licensing is <strong>strongly</strong> recommended on Production deployments.</p><p>For this guide we will use the <strong>Windows Server 2019 Evaluation Image</strong>. More
evaluation images can be found in Microsoft’s Evaluation Center.</p><p><img alt="Evaluation Center banner" src="/docs/manuals/assets/images/Untitled_2-b2a67b1149869184ee908df702b98a19.png"></p><p><a href="https://www.microsoft.com/en-us/evalcenter/download-windows-server-2019" target="_blank" rel="noopener noreferrer">https://www.microsoft.com/en-us/evalcenter/download-windows-server-2019</a></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="redhat-virtio-drivers-iso"><strong>RedHat Virtio Drivers ISO</strong><a class="hash-link" href="#redhat-virtio-drivers-iso" title="Direct link to heading">​</a></h2><p>Additional drivers must be provided during installation to allow Windows to detect
VirtIO network and storage types. You will attach an additional ISO to the
instance as it is created to enable the ability to interact with OpenStack’s
default storage types within Windows. More information as well as the ISO
download link can be found here:</p><p><a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/?C=M;O=D" target="_blank" rel="noopener noreferrer">https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/?C=M;O=D</a></p><p><img alt="virtio-win download page" src="/docs/manuals/assets/images/Untitled_3-430f174c81da80437db46ee4836671d2.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="virtio-win-version">virtio-win Version<a class="hash-link" href="#virtio-win-version" title="Direct link to heading">​</a></h3><blockquote><p><strong>Caution!</strong> In our experience newer <strong>does not</strong> mean it will work for your
desired OS distribution. Depending on the Operating System - older versions
of virtio-win may be suitable for older versions of Windows. For example, the
latest version of this driver (0.1.217-2) did not work well on Windows 10
Enterprise, but a version before it did (0.1.215-2). Unfortunately this is a
trial by fire experience, there are ways to identify the right fit during
installation that will be covered later in the guide.</p></blockquote><h2 class="anchor anchorWithStickyNavbar_y2LR" id="preparing-our-environment">Preparing our Environment<a class="hash-link" href="#preparing-our-environment" title="Direct link to heading">​</a></h2><p>Now that you have obtained the above it’s time to setup our initial instance,
deploy KVM packages to build our Windows instance, download and upload our ISOs,
and go through the Windows setup process.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="provision-network-for-vm-access">Provision Network for VM Access<a class="hash-link" href="#provision-network-for-vm-access" title="Direct link to heading">​</a></h2><p>We deployed an internal network called Private with a 192.168.0.0/24 subnet, and
set up a router connected to the External network with a port on the internal
network for our Private network’s gateway. We also got a Floating IP added to a
provisioned Ubuntu instance. For more information on setting up some initial
networking you can refer to our guide here: <a href="https://openmetal.io/docs/manuals/users-manual/create-a-network/" target="_blank" rel="noopener noreferrer">Networking in OpenStack</a></p><p><img alt="Network details" src="/docs/manuals/assets/images/Untitled_4-8de1f37aa0df0e7d6bf6b9433182a223.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="security-groups">Security Groups<a class="hash-link" href="#security-groups" title="Direct link to heading">​</a></h2><p>One of the most common things to forget is that OpenStack has a closed by default
security model, so since we will need to access the instance over SSH (port 22)
and eventually connect with VNC Viewer (port 5900), we will want to create a
rule allowing our IP to either all ports, or specific ports. We created a
security group called “Remote Windows Image Building”</p><p><img alt="Security Group Details" src="/docs/manuals/assets/images/Untitled_5-7937ac1638bb6d5260ec75884aa9ef70.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="create-and-access-our-instance">Create and Access our Instance<a class="hash-link" href="#create-and-access-our-instance" title="Direct link to heading">​</a></h2><blockquote><p>Note: This example uses an Ubuntu 20 (Focal) Image however, any OS on which
you can install KVM on should work.</p></blockquote><p>The screenshots below illustrate some of the selections made during Instance
creation. For more on how to create and access instances on OpenStack refer to
<a href="https://openmetal.io/docs/manuals/openstack-users/how-to-create-an-instance/" target="_blank" rel="noopener noreferrer">How to create an instance</a>.</p><ul><li>Ubuntu 20 VM Image</li><li>4 VCPU, 16 GB Ram, 50 GB Disk (m1.large flavor)</li><li>On Private Network</li><li>With selected SSH public key</li><li>Security Groups for SSH (Firewall)</li><li>Floating IP for external access</li></ul><p>Here are some screenshots from our selections.</p><p><img alt="Instance details" src="/docs/manuals/assets/images/Untitled_6-167c9504c4f41ba7f803b73e389b4926.png"></p><p>Once created, attach our floating IP to the instance which should now be
accessible via SSH from the IP we allowed in our Security Group. Any SSH Client
can be used to access the Ubuntu instance using your private key pair for
authentication.</p><blockquote><p><strong>Note</strong>: The username for the Ubuntu cloud image is <strong>ubuntu.</strong> That user
will have root/administrative privileges to configure the rest of what we need.</p></blockquote><p><img alt="Instance ssh" src="/docs/manuals/assets/images/Untitled_7-e3bbddbfeaf012d88c01e9714f6beca0.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="install-packages">Install Packages<a class="hash-link" href="#install-packages" title="Direct link to heading">​</a></h2><p>Running a Virtual Machine inside of this instance requires KVM (Kernel-based
Virtual Machines) packages and their dependencies. Additional tools and utilities
are installed to  help us navigate the environment and facilitate ISO downloads.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> update -y</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt</span><span class="token plain"> -y </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> qemu qemu-kvm libvirt-clients libvirt-daemon-system virt-manager bridge-utils cpu-checker libosinfo-bin</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Let’s make sure the system supports virtualization and acceleration.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> -Eoc </span><span class="token string" style="color:#e3116c">&#x27;(vmx|svm)&#x27;</span><span class="token plain"> /proc/cpuinfo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">4</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ kvm-ok </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO: /dev/kvm exists</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">KVM acceleration can be used</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>For the vmx/svm check you are making sure that the CPUs loaded into your system
support virtualization. The number should match the number of VCPUs assigned to
the instance or CPUs on your host.</p><p><code>kvm-ok</code> is a command to confirm KVM acceleration is available on running hardware.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="download-and-transfer-necessary-artifacts">Download and transfer necessary artifacts<a class="hash-link" href="#download-and-transfer-necessary-artifacts" title="Direct link to heading">​</a></h2><p>When you create your Windows Instance, the previously mentioned Windows ISOs and
the virtio-win driver ISO need to be available on the instance.</p><p>Download the win-virtio driver ISO with the following command.</p><blockquote><p><strong>Note</strong>: You can modify the link according to the version of win-virtio
that you would like to test with.</p></blockquote><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/virtio-win-0.1.217-2/virtio-win-0.1.217.iso</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">virtio-win-0.1.217.iso</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This command will download the file at the URL specified.</p><p>For the Windows Evaluation ISO image you may need to fill out of a form. As
previously mentioned, for this exercise we obtained the <strong>Windows Server 2019
Evaluation Image</strong> from the <a href="https://www.microsoft.com/en-us/evalcenter/download-windows-server-2019" target="_blank" rel="noopener noreferrer">Evaluation Center</a></p><p>The link that was generated through Copy Link can be passed to wget in your
instance to download the Windows ISO file.</p><p><img alt="Copy download link" src="/docs/manuals/assets/images/Untitled_8-a45df3d0592ba2cd49cd6f7ce2ef364e.png"></p><blockquote><p>The <code>-O $name</code> command flag renames the downloaded file during download.
Wget attempts to name the saved file to match what follows the last <code>/</code> in the
link by default, this can result in confusion as redirects may create multiple
files with varying names to sort through to understand which one is the real ISO.</p></blockquote><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">wget</span><span class="token plain"> -O Windows.iso </span><span class="token string" style="color:#e3116c">&quot;https://go.microsoft.com/fwlink/p/?LinkID=2195167&amp;clcid=0x409&amp;culture=en-us&amp;country=US&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-06-27 </span><span class="token number" style="color:#36acaa">23</span><span class="token plain">:36:11 </span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">65.1</span><span class="token plain"> MB/s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> - ‘Windows.iso’ saved </span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">5296713728</span><span class="token plain">/5296713728</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Windows.iso  virtio-win-0.1.217.iso</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This link may not work for you by the time you follow this guide, or the process
of obtaining the ISO may change over time. Adjust the link as needed or pursue
other methods.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="run-the-windows-instance">Run the Windows Instance<a class="hash-link" href="#run-the-windows-instance" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_y2LR" id="create-disk-for-the-vm">Create Disk for the VM<a class="hash-link" href="#create-disk-for-the-vm" title="Direct link to heading">​</a></h3><p>First create a storage disk for our instance with the necessary VirtIO drivers
for storage parity.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ qemu-img create -f qcow2 windowsserver2019.qcow2 15G</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Formatting </span><span class="token string" style="color:#e3116c">&#x27;windowsserver2019.qcow2&#x27;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">fmt</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">qcow2 </span><span class="token assign-left variable" style="color:#36acaa">size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">16106127360</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">cluster_size</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">65536</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">lazy_refcounts</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">off </span><span class="token assign-left variable" style="color:#36acaa">refcount_bits</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">16</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This creates a 15GB disk image that will be used as our hard drive for Windows
in qcow2 format.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="find-out-your-os-short-id">Find out your OS short ID<a class="hash-link" href="#find-out-your-os-short-id" title="Direct link to heading">​</a></h3><p>The following command displays the various operating systems QEMU can emulate
with corresponding OS variant short ID. Make note as we will use this later.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ osinfo-query os</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win2k12              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Microsoft Windows Server </span><span class="token number" style="color:#36acaa">2012</span><span class="token plain">                      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6.3</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://microsoft.com/win/2k12           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win2k12r2            </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Microsoft Windows Server </span><span class="token number" style="color:#36acaa">2012</span><span class="token plain"> R2                   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6.3</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://microsoft.com/win/2k12r2         </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win2k16              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Microsoft Windows Server </span><span class="token number" style="color:#36acaa">2016</span><span class="token plain">                      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.0</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://microsoft.com/win/2k16           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win2k19              </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Microsoft Windows Server </span><span class="token number" style="color:#36acaa">2019</span><span class="token plain">                      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">10.0</span><span class="token plain">     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://microsoft.com/win/2k19           </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win2k3               </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Microsoft Windows Server </span><span class="token number" style="color:#36acaa">2003</span><span class="token plain">                      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5.2</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://microsoft.com/win/2k3            </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win2k3r2             </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Microsoft Windows Server </span><span class="token number" style="color:#36acaa">2003</span><span class="token plain"> R2                   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">5.2</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://microsoft.com/win/2k3r2          </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">win2k8               </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Microsoft Windows Server </span><span class="token number" style="color:#36acaa">2008</span><span class="token plain">                      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">6.0</span><span class="token plain">      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> http://microsoft.com/win/2k8</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>From the above output, we see that our OS variant for Windows Server 2019 is <code>win2k19</code>.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="start-the-instance">Start the Instance<a class="hash-link" href="#start-the-instance" title="Direct link to heading">​</a></h3><p>The following command is quite lengthy but we will break it down below.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> virt-install --connect qemu:///system --name windowsserver2019 </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --ram </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"> --vcpus </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> --network </span><span class="token assign-left variable" style="color:#36acaa">network</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">default,model</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">virtio </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --disk </span><span class="token assign-left variable" style="color:#36acaa">path</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">windowsserver2019.qcow2,format</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">qcow2,device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">disk,bus</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">virtio </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --cdrom Windows.iso --disk </span><span class="token assign-left variable" style="color:#36acaa">path</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">virtio-win-0.1.217.iso,device</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">cdrom </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --graphics</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">vnc,password</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">IvkOMXKUd5LES6Zp,listen</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0.0</span><span class="token plain">.0.0,port</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">5900</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> --os-type windows --os-variant win2k19 --noautoconsole</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Starting install</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain installation still </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> progress. You can reconnect to </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">the console to complete the installation process.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">virsh</span><span class="token plain"> list --all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Id   Name                State</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-----------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">    windowsserver2019   running</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This will start our VM with the attributes and options needed for the setup
process. Here is what all the options mean:</p><ul><li><code>sudo virt-install</code>:
command line tool to create virtual machine as Admin user</li><li><code>--connect qemu:///system</code>:
use the QEMU emulation system socket</li><li><code>--name windowsserver2019</code>:
name of our Virtual Machine</li><li><code>--ram 4096</code>:
Memory allocated to VM in Megabytes, 4GB</li><li><code>--vcpus 1</code>:
How many CPUs to give this VM, 1</li><li><code>--network network=default,model=virtio</code>:
network configuration, VirtIO device topology</li><li><code>--disk path=windowsserver2019.qcow2,format=qcow2,device=disk,bus=virtio</code>:
name and relative path to our Disk file to use for this VM, format of this
storage medium and VirtIO device topology</li><li><code>--cdrom Windows.iso</code>:
our CD-Rom device loaded with the relative path of our Windows ISO</li><li><code>--disk path=virtio-win-0.1.217.iso,device=cdrom</code>:
Our secondary CD-Rom device loaded with the relative path of our win-virtio
driver ISO</li><li><code>--graphics=vnc,password=IvkOMXKUd5LES6Zp,listen=0.0.0.0,port=5900</code>:
Use VNC for our graphic emulation, with password protected connection, listen
on port 5900 for all network interfaces</li><li><code>--os-type windows --os-variant win2k19</code>:
Details of the operating system we will be emulating</li><li><code>--noautoconsole</code>:
Don’t automatically try to connect to the guest console after the command is
issued (since we will be using VNC), just run the instance in background.</li></ul><h3 class="anchor anchorWithStickyNavbar_y2LR" id="connect-to-your-windows-instance-via-vnc">Connect to your Windows Instance via VNC<a class="hash-link" href="#connect-to-your-windows-instance-via-vnc" title="Direct link to heading">​</a></h3><p>Now that the instance is running we should be able to connect to it using VNC
client we previously installed on our host.</p><p><img alt="Quick connect" src="data:image/png;base64,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"></p><p><img alt="Authentication" src="/docs/manuals/assets/images/Untitled_10-973377c7a465fc0904e6c1cdd616cc7e.png"></p><p>You should see the console output of your nested instance.</p><p><img alt="Console output" src="/docs/manuals/assets/images/Untitled_11-16ab8e0d9433f1dad9dcc0d138620996.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="install-windows">Install Windows<a class="hash-link" href="#install-windows" title="Direct link to heading">​</a></h2><p>Go through the standard install journey.</p><p><img alt="Install journey" src="/docs/manuals/assets/images/Untitled_12-8eea3e0965d5ba55d6fb1b59f40d0cfe.png"></p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="setup-virtio-drivers-for-installation">Setup VirtIO Drivers for Installation<a class="hash-link" href="#setup-virtio-drivers-for-installation" title="Direct link to heading">​</a></h2><p>When the partitioning step is reached the system will not be able to detect the
storage or network device until the VirtIO drivers are installed, this behavior
is intentional.</p><p><img alt="Missing disks" src="/docs/manuals/assets/images/Untitled_13-6deb4ca9ba2d1d9f64d6c53373168315.png"></p><p>Click Load Driver &gt; Browse &gt; uncheck the “Hide drivers…” option box. Traverse
the virtio-win ISO image to locate the appropriate folders.</p><p><img alt="Folder selection" src="/docs/manuals/assets/images/Untitled_14-3ada5ae7eef0d9242901c3790d987e07.png"></p><p>There are typically 3 Folders to be aware of during installation.</p><ul><li>NetKVM - VirtIO Network Drivers</li><li>Viostor - VirtIO Block Storage Drivers</li><li>Vioscsi - VirtIO SCSI Storage Drivers</li></ul><p>You will need to traverse each folder, locate the corresponding OS variant and
install all of the drivers contained in that folder.</p><p><img alt="NetKVM path" src="/docs/manuals/assets/images/Untitled_15-750cc2dc37bf8bf85b615434d0e7646e.png"></p><p>Shift + Click to select multiple driver files.</p><p><img alt="Driver select" src="/docs/manuals/assets/images/Untitled_16-8ceaac00c51f5cd38d024f9a89a72c49.png"></p><p>Click Next to install.</p><p>Repeat for viostor</p><p><img alt="viostor path" src="/docs/manuals/assets/images/Untitled_17-cf003c20082a05d35f3abefed82c9323.png"></p><p><img alt="Driver select" src="/docs/manuals/assets/images/Untitled_18-54e69c07e5bb272a7a25464b5e82b5c4.png"></p><p>We now see Windows Installer detect our storage medium, installation can proceed.</p><p><img alt="Disks exist" src="/docs/manuals/assets/images/Untitled_19-eaeae6b32727637b5886bad837101430.png"></p><p>Clicking Next will start Windows installing.</p><p><img alt="Install progress" src="/docs/manuals/assets/images/Untitled_20-e6215c494c39e3ccb0d5f20133a8f9ac.png"></p><p>After the installation completes the instance will shut off and will need to be
restarted manually through your image-builder instance SSH command line interface:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">virsh</span><span class="token plain"> list --all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> Id   Name                State</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">------------------------------------</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> -    windowsserver2019   shut off</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">virsh</span><span class="token plain"> start windowsserver2019</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Domain windowsserver2019 started</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Reconnect to the instance via VNC and be greeted with the Windows Loading screen
followed by Administrator account setup.</p><p><img alt="Admin setup" src="/docs/manuals/assets/images/Untitled_21-9ed9a1631ff3a22f6fdae5aa143671ac.png"></p><p>There will be a Ctrl+Alt+Del requirement to unlock the screen. VNC viewer has a
shortcut, simply hover over the top layer of the screen.</p><p><img alt="Ctrl+Alt+Del shortcut" src="/docs/manuals/assets/images/Untitled_22-f77a7b0f90a01e7d71854c38f06cd96f.png"></p><p>Continue to your login by issuing the Ctrl+Alt+Delete shortcut and entering the
password you just set for the Administrator account.</p><p><img alt="Success" src="/docs/manuals/assets/images/Untitled_23-b9ae937a46b3c8d52a1a0e2df9410493.png"></p><p>You have now have successfully installed Windows in a nested Virtual Machine.
Next we focus on preparing and packaging this Windows VM for Cloud provisioning
and reuse.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="preparing-and-configuring-windows">Preparing and Configuring Windows<a class="hash-link" href="#preparing-and-configuring-windows" title="Direct link to heading">​</a></h2><p>There are a few things we will need to do for this Windows Installation</p><ul><li>Install VirtIO Drivers</li><li>Setup Remote Access</li><li>Configure Cloudbase Init</li></ul><blockquote><p>If you are installing Windows 10 or other various Windows Distributions - now
is the time to debloat, install what software you require, setup users, etc.</p></blockquote><h3 class="anchor anchorWithStickyNavbar_y2LR" id="install-virtio-drivers">Install VirtIO Drivers<a class="hash-link" href="#install-virtio-drivers" title="Direct link to heading">​</a></h3><p>This step of the process that lets us know whether the virtio-win driver ISO we
selected was the right one. Open the ISO device via File Manager and execute
the virtio driver installer.</p><p><img alt="File manager" src="/docs/manuals/assets/images/Untitled_24-ec84154dbd526a5c8481054634ccda7b.png"></p><p><img alt="Virtio-win installer" src="/docs/manuals/assets/images/Untitled_25-8cab55a4a10699b07849d885ce4eb133.png"></p><blockquote><p><strong>Warning!</strong>: If <em>Any Errors</em> occur in the driver installation process you
should try another version of virtio-win ISO.</p></blockquote><p>If everything works as intended you should end up on the following screen without
error.</p><p><img alt="Installer complete" src="/docs/manuals/assets/images/Untitled_26-9926577974ae3a49e04abe253f8d3aab.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="install-virtio-guest-tools">Install VirtIO Guest Tools<a class="hash-link" href="#install-virtio-guest-tools" title="Direct link to heading">​</a></h3><p>Same process as above.</p><p><img alt="Guest tools setup" src="/docs/manuals/assets/images/Untitled_27-c4bdacb2eb71bf75e1e95973488c1b62.png"></p><p><img alt="Installation Successfully" src="/docs/manuals/assets/images/Untitled_28-25bce64e30662db7788bad96153bf66a.png"></p><blockquote><p><strong>Note</strong>: After spice tools installation, often the mouse cursor changes to a
transparent white which is difficult to follow on white background. If you
experience , the easiest fix is to open Advanced Mouse Options and select a
different pointer icon.</p></blockquote><p><img alt="Mouse properties" src="/docs/manuals/assets/images/Untitled_29-f9fa8df06d8e9d18978c997ac1475167.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="enable-remote-desktop">Enable Remote Desktop<a class="hash-link" href="#enable-remote-desktop" title="Direct link to heading">​</a></h3><p>If you plan to connect to the server via RDP (Don’t forget to add the RDP port
to your future Security Groups) you may want to enable remote access for this
Windows Instance.</p><p><img alt="RDP settings" src="/docs/manuals/assets/images/Untitled_30-8b9ed4292de7614db0976815ebbdb2c3.png"></p><p>On <strong>Windows 10 for example</strong> this may look like image below.</p><p><img alt="Win10 RDP settings" src="/docs/manuals/assets/images/Untitled_31-71332f839e0849949c8bb22bff72b961.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="correct-disk-configuration">Correct Disk Configuration<a class="hash-link" href="#correct-disk-configuration" title="Direct link to heading">​</a></h3><p>While not an issue in this example, removal of the Recovery Partition may be
required when installing Windows 10 or other distributions.</p><p><img alt="Correct partitioning" src="/docs/manuals/assets/images/Untitled_32-4da708274a9d81fdc1da5464dd14c50a.png"></p><p>In our case, as seen above, the last partition of Disk 0 is the C partition,
however on some other Windows versions a Recovery Partition exists <strong>after</strong>
the C partition.</p><p><img alt="Trailing recovery partition" src="/docs/manuals/assets/images/Untitled_33-8beff5f19e9837625b4eb026d59248d6.png"></p><p>In these cases <strong>you will need to delete it</strong> in order for cloud native tools to
resize your C drive on dynamic drive cloud instance creation.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="install-cloudbase-init">Install CloudBase Init<a class="hash-link" href="#install-cloudbase-init" title="Direct link to heading">​</a></h3><p>Cloudbase Init can append various Windows Distributions with cloud native
provisioning capabilities such as Administrator password retrieval, volume
expansion, and network interface capabilities as well as useful utilities.
Supported Windows distributions are listed here:
<a href="https://cloudbase.it/cloudbase-init/" target="_blank" rel="noopener noreferrer">https://cloudbase.it/cloudbase-init/</a></p><p>Before you download the installer, Windows Server distributions are configured
with IE Enhanced Security Configuration enabled by default. Disable this
temporarily as described below.</p><p>In Server Manager navigate to Local Server on the left then click &quot;On&quot; to the
right of IE Enhanced Security Configuration.</p><p><img alt="Server Manager" src="/docs/manuals/assets/images/enhanced-sec-config-7d39decf0d11aa3e41f5bf17c9fd7255.png"></p><p>Set Administrators to Off and click OK</p><p><img alt="Admin set" src="/docs/manuals/assets/images/enable-admin-dc19b119ae00ed17968be9d9f9b61534.png"></p><p>Download and Run the Installer</p><p><img alt="cloudbase.it download page" src="/docs/manuals/assets/images/Untitled_37-380c00d53bdd06c8819a8faf66ed943f.png"></p><p><img alt="Cloudbase-init Wizard" src="/docs/manuals/assets/images/Untitled_38-cd71bcb5a2e42329ed7d02f50c7fa446.png"></p><p>Accept defaults until this screen is reached.</p><p><img alt="Configuration options" src="/docs/manuals/assets/images/Untitled_39-854e9fcc5ad4019bbd0a0dc993818e42.png"></p><p> Ensure that <code>Serial port for logging:</code> is set to <code>COM1</code> for later OpenStack
console integration.</p><p>The option to enable LocalSystem support is present per the reasoning, from
Cloudbase, below.</p><blockquote><p>The reason why we added a new <em>cloudbase-init</em> user account is that some user
data actions performed during guest initializations, e.g. installing non trivial
packages like SharePoint server, require a proper user logon profile and fail
when executed as <em>Local System</em></p></blockquote><p>CloudBase Init allows for customization of your created images, learn more in
their <a href="https://cloudbase-init.readthedocs.io/en/latest/tutorial.html" target="_blank" rel="noopener noreferrer">documentation</a></p><blockquote><p>Note: At this point it is recommended to ensure that all available updates,
service packs and required software changes are complete and applied. This
will ensure that minimal time is required for maintenance of new instances
created from the image.</p></blockquote><p>You will want to make these modifications before running SysPrep.</p><p><img alt="Wizard complete" src="/docs/manuals/assets/images/Untitled_40-8a468ccd05ba2db49bce9df414067b5f.png"></p><p>Make sure you&#x27;ve made all desired adjustments, once you run SysPrep the image is
finalized.</p><p>Click Finish and the system will shut down.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="upload-our-windows-image-to-your-openmetal-openstack-cloud">Upload our Windows Image to your OpenMetal OpenStack Cloud<a class="hash-link" href="#upload-our-windows-image-to-your-openmetal-openstack-cloud" title="Direct link to heading">​</a></h2><p>Now that your Windows VM is installed, configured, and stored in your
windowsserver2019.qcow2 image, it can be uploaded to your cloud for reuse and
general provisioning by all of your OpenStack users and administrators.</p><p>You can utilize OpenStack CLI from within the image-builder instance we created
to build our Windows VM Image, and use it to upload our hard work and result to
OpenMetal cloud from which we initially began our journey. It’s “Cloud Inception”.</p><p>Refer to the following for setup of <a href="https://openmetal.io/docs/manuals/openstack-operators/how-to-install-and-use-openstacks-cli/" target="_blank" rel="noopener noreferrer">OpenStack CLI</a>
and <a href="https://docs.openstack.org/python-openstackclient/latest/cli/command-objects/image-v1.html#image-create" target="_blank" rel="noopener noreferrer">uploading images</a>
to your cloud.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ </span><span class="token function" style="color:#d73a49">sudo</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">apt-get</span><span class="token plain"> -y </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> python3-venv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ python3 -m venv venv</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@image-builder:~$ </span><span class="token builtin class-name">.</span><span class="token plain"> venv/bin/activate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">venv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ubuntu@image-builder:~$ pip </span><span class="token function" style="color:#d73a49">install</span><span class="token plain"> wheel python-openstackclient</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">venv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ubuntu@image-builder:~$ </span><span class="token builtin class-name">.</span><span class="token plain"> admin-openrc.sh </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Please enter your OpenStack Password </span><span class="token keyword" style="color:#00009f">for</span><span class="token plain"> project admin as user admin:</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>If uncertain how <code>admin-rc.sh</code> was obtained and sourced please refer to the
documentation linked above. To allow all users of your cloud to use this Windows
Image, we create it under the admin user and project of the OpenStack cloud.</p><p>RAW images have been shown to noticeably outperform qcow2 on Block Device shared
file storage as configured on OpenMetal Clouds, you will now convert your qcow2
image to RAW format:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">venv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ubuntu@image-builder:~$ qemu-img convert -f qcow2 -O raw windowsserver2019.qcow2 WindowsSever2019.raw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">venv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ubuntu@image-builder:~$ </span><span class="token function" style="color:#d73a49">ls</span><span class="token plain"> -lashr </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">grep</span><span class="token plain"> -i windows</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9</span><span class="token plain">.7G -rw-r--r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> ubuntu       ubuntu </span><span class="token number" style="color:#36acaa">9</span><span class="token plain">.7G Jun </span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token plain">:58 windowsserver2019.qcow2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">9</span><span class="token plain">.5G -rw-r--r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> ubuntu       ubuntu  15G Jun </span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">:29 WindowsSever2019.raw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token number" style="color:#36acaa">5</span><span class="token plain">.0G -rw-rw-r-- </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"> libvirt-qemu kvm    </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">.0G Sep </span><span class="token number" style="color:#36acaa">21</span><span class="token plain">  </span><span class="token number" style="color:#36acaa">2019</span><span class="token plain"> Windows.iso</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As we are converting a 9.7GB image from qcow2 to a 15GB RAW image, the above
command may take a few minutes.</p><p>The upload command we use:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">openstack image create --progress </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--min-disk </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> --min-ram </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"> --public </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">--file WindowsSever2019.raw </span><span class="token punctuation" style="color:#393A34">\</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token string" style="color:#e3116c">&quot;Windows Server 2019&quot;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Results in output as follows:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">venv</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> ubuntu@image-builder:~$ openstack image create --progress --min-disk </span><span class="token number" style="color:#36acaa">15</span><span class="token plain"> --min-ram </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain"> --public --file WindowsSever2019.raw </span><span class="token string" style="color:#e3116c">&quot;Windows Server 2019&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">100</span><span class="token plain">%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Field            </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Value                                                                                                                                                                   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> container_format </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> bare                                                                                                                                                                    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> created_at       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-06-28T15:34:32Z                                                                                                                                                    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> disk_format      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> raw                                                                                                                                                                     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">file</span><span class="token plain">             </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> /v2/images/8305ddb7-a5d7-477e-adfe-9fb31da776e0/file                                                                                                                    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">id</span><span class="token plain">               </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 8305ddb7-a5d7-477e-adfe-9fb31da776e0                                                                                                                                    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> min_disk         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">15</span><span class="token plain">                                                                                                                                                                      </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> min_ram          </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4096</span><span class="token plain">                                                                                                                                                                    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> name             </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> Windows Server </span><span class="token number" style="color:#36acaa">2019</span><span class="token plain">                                                                                                                                                     </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> owner            </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> 4b6b7670416f461fb9980db8384ccbbd                                                                                                                                        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> properties       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token assign-left variable" style="color:#36acaa">locations</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;[]&#x27;</span><span class="token plain">, </span><span class="token assign-left variable" style="color:#36acaa">os_hidden</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;False&#x27;</span><span class="token plain">, owner_specified.openstack.md5</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain">, owner_specified.openstack.object</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;images/Windows Server 2019&#x27;</span><span class="token plain">, owner_specified.openstack.sha256</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">&#x27;&#x27;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> protected        </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> False                                                                                                                                                                   </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> schema           </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> /v2/schemas/image                                                                                                                                                       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> status           </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> queued                                                                                                                                                                  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> tags             </span><span class="token operator" style="color:#393A34">|</span><span class="token plain">                                                                                                                                                                         </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> updated_at       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">2022</span><span class="token plain">-06-28T15:34:32Z                                                                                                                                                    </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> visibility       </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> public                                                                                                                                                                  </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">+------------------+-------------------------------------------------------------------------------------------------------------------------------------------------------------------------+</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>As we are performing this build “in the cloud” we benefit from datacenter speeds.
If the image was built locally (eg. at home or in your office) your upload speed
is limited by your service provider. 15GB at 100MBits/s would take roughly 22
minutes, if you are not so lucky and your ISP only provides 10Mbps upload speeds,
the upload would take 3+ hours. For us however it should take just about ~5
minutes.</p><p>We can now see our uploaded image in our Horizon interface Images section at the
bottom.</p><p><img alt="Horizon images" src="/docs/manuals/assets/images/Untitled_41-6399729e5e62bc06e4678ff597cb4730.png"></p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="update-image-socket-maximum">Update Image Socket Maximum<a class="hash-link" href="#update-image-socket-maximum" title="Direct link to heading">​</a></h3><p>In the process of working with Windows 10 instances we learned that certain
Windows Distributions are restricted in the maximum amount of sockets they can
use. Online research identified the following information which appears to be
accurate:</p><ul><li><strong>Windows 10 Home</strong>: 1 CPU</li><li><strong>Windows 10 Professional</strong>: 2 CPU</li><li><strong>Windows 10 Workstation</strong>: up to 4 CPU</li><li><strong>Windows Server 2016</strong>: up to 64 CPU</li></ul><p>As sockets represent the amount of physical CPU sockets/processors (Not actual
CPU cores) on the virtual server, we may want to limit our Image setting a maximum
number. Our provisioning system may assign more than the limit, while Windows
will ignore all vCPUs beyond it&#x27;s own limit.</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">openstack image </span><span class="token builtin class-name">set</span><span class="token plain"> 8305ddb7-a5d7-477e-adfe-9fb31da776e0 --property </span><span class="token assign-left variable" style="color:#36acaa">hw_cpu_max_sockets</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Adjust the number to the desired amount of physical processors your OS chosen
distribution supports.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="test-out-provisioning-the-new-windows-image">Test Out Provisioning the new Windows Image<a class="hash-link" href="#test-out-provisioning-the-new-windows-image" title="Direct link to heading">​</a></h2><p>For our test we used the following parameters on an OpenMetal Cloud</p><ul><li>Instance Name - WServer2019</li><li>Source - Windows Server 2019 Image</li><li>Flavor - c1.xlarge</li><li>Network - Private (Previously configured in this project)</li></ul><p>After launch, it takes a few minutes for CloudInit to complete first run,
configuring the initial user, after a few moments we see:</p><p><img alt="Win instance running" src="/docs/manuals/assets/images/Untitled_42-29145a66ae888df0fb5d885fd9d9f19a.png"></p><p>Once CloudInit completes you will see the familiar interface by accessing Console
view of your instance in the Horizon Interface (This is the importance of <code>COM1</code>).</p><p><img alt="Win instance console" src="/docs/manuals/assets/images/Untitled_43-a71d2a3d5c3e3e6851713951eb08efeb.png"></p><p>Congratulations! You have successfully built and configured a Windows Server 2019
Image capable of running on your OpenMetal OpenStack cloud. You can use the
<code>Admin</code> user provisioned by CloudBase which is not initially displayed at login,
or proceed with Administrator credential reset.</p><p>Our hard drive was automatically expanded to the <code>c1.xlarge</code> flavor defined size.</p><p><img alt="Expanded primary partition" src="/docs/manuals/assets/images/Untitled_44-793a60c472013c30c5753df45101235a.png"></p><p>We also detect 4 processors and a total of 8 VCPUs</p><p><img alt="Windows CPU stats" src="/docs/manuals/assets/images/Untitled_45-6c387b08e55f1834da1e8fe6f75979cb.png"></p><p>RDP connections to the CloudBase user and password retrieval functionality will
be covered in a future article.</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="suggestions-and-conclusions">Suggestions and Conclusions<a class="hash-link" href="#suggestions-and-conclusions" title="Direct link to heading">​</a></h2><p>It will take you quite a few attempts building a Windows VM Image before you
understand all of the things you may need to configure and install to be happy
with the end result. We found this to be a learning experience as each time we
had to iterate another change or customization to the process.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openmetalio/openmetal-docs/blob/main/docs/engineers-notes/building-windows-cloud-images-on-openmetal.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/manuals/tutorials/install-configure-barbican-openmetal"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">How to install and configure Barbican on your OpenMetal Cloud</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/manuals/kubernetes-guides/installing-an-openshift-cluster-on-openstack"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Installing an OpenShift cluster on OpenStack</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#images-for-openstack" class="table-of-contents__link toc-highlight">Images for OpenStack</a></li><li><a href="#tools-required-for-this-guide" class="table-of-contents__link toc-highlight">Tools required for this guide</a></li><li><a href="#openmetal-cloud" class="table-of-contents__link toc-highlight">OpenMetal Cloud</a></li><li><a href="#vnc-viewer" class="table-of-contents__link toc-highlight">VNC Viewer</a></li><li><a href="#windows-iso" class="table-of-contents__link toc-highlight">Windows ISO</a></li><li><a href="#redhat-virtio-drivers-iso" class="table-of-contents__link toc-highlight"><strong>RedHat Virtio Drivers ISO</strong></a><ul><li><a href="#virtio-win-version" class="table-of-contents__link toc-highlight">virtio-win Version</a></li></ul></li><li><a href="#preparing-our-environment" class="table-of-contents__link toc-highlight">Preparing our Environment</a></li><li><a href="#provision-network-for-vm-access" class="table-of-contents__link toc-highlight">Provision Network for VM Access</a></li><li><a href="#security-groups" class="table-of-contents__link toc-highlight">Security Groups</a></li><li><a href="#create-and-access-our-instance" class="table-of-contents__link toc-highlight">Create and Access our Instance</a></li><li><a href="#install-packages" class="table-of-contents__link toc-highlight">Install Packages</a></li><li><a href="#download-and-transfer-necessary-artifacts" class="table-of-contents__link toc-highlight">Download and transfer necessary artifacts</a></li><li><a href="#run-the-windows-instance" class="table-of-contents__link toc-highlight">Run the Windows Instance</a><ul><li><a href="#create-disk-for-the-vm" class="table-of-contents__link toc-highlight">Create Disk for the VM</a></li><li><a href="#find-out-your-os-short-id" class="table-of-contents__link toc-highlight">Find out your OS short ID</a></li><li><a href="#start-the-instance" class="table-of-contents__link toc-highlight">Start the Instance</a></li><li><a href="#connect-to-your-windows-instance-via-vnc" class="table-of-contents__link toc-highlight">Connect to your Windows Instance via VNC</a></li></ul></li><li><a href="#install-windows" class="table-of-contents__link toc-highlight">Install Windows</a></li><li><a href="#setup-virtio-drivers-for-installation" class="table-of-contents__link toc-highlight">Setup VirtIO Drivers for Installation</a></li><li><a href="#preparing-and-configuring-windows" class="table-of-contents__link toc-highlight">Preparing and Configuring Windows</a><ul><li><a href="#install-virtio-drivers" class="table-of-contents__link toc-highlight">Install VirtIO Drivers</a></li><li><a href="#install-virtio-guest-tools" class="table-of-contents__link toc-highlight">Install VirtIO Guest Tools</a></li><li><a href="#enable-remote-desktop" class="table-of-contents__link toc-highlight">Enable Remote Desktop</a></li><li><a href="#correct-disk-configuration" class="table-of-contents__link toc-highlight">Correct Disk Configuration</a></li><li><a href="#install-cloudbase-init" class="table-of-contents__link toc-highlight">Install CloudBase Init</a></li></ul></li><li><a href="#upload-our-windows-image-to-your-openmetal-openstack-cloud" class="table-of-contents__link toc-highlight">Upload our Windows Image to your OpenMetal OpenStack Cloud</a><ul><li><a href="#update-image-socket-maximum" class="table-of-contents__link toc-highlight">Update Image Socket Maximum</a></li></ul></li><li><a href="#test-out-provisioning-the-new-windows-image" class="table-of-contents__link toc-highlight">Test Out Provisioning the new Windows Image</a></li><li><a href="#suggestions-and-conclusions" class="table-of-contents__link toc-highlight">Suggestions and Conclusions</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Products</div><ul class="footer__items"><li class="footer__item"><a href="https://openmetal.io/products/private-cloud/hosted/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>On-Demand Private Cloud</span></a></li><li class="footer__item"><a href="https://openmetal.io/products/large-iaas-deployments/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Large Deployments</span></a></li><li class="footer__item"><a href="https://openmetal.io/products/private-pods/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Private Pods</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Solutions</div><ul class="footer__items"><li class="footer__item"><a href="https://openmetal.io/solutions/saas/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>SaaS Cloud</span></a></li><li class="footer__item"><a href="https://openmetal.io/solutions/it-modernization/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>IT Modernization</span></a></li><li class="footer__item"><a href="https://openmetal.io/solutions/openstack-public-cloud-providers/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Public Cloud Providers</span></a></li><li class="footer__item"><a href="https://openmetal.io/solutions/on-demand-openstack-cloud/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>On-Demand OpenStack</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Platform</div><ul class="footer__items"><li class="footer__item"><a href="https://openmetal.io/platform/openstack-services/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>OpenStack Services</span></a></li><li class="footer__item"><a href="https://openmetal.io/platform/features/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Features and Components</span></a></li><li class="footer__item"><a href="https://openmetal.io/platform/locations/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Global Locations</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Pricing</div><ul class="footer__items"><li class="footer__item"><a href="https://openmetal.io/pricing/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>On-Demand Pricing</span></a></li><li class="footer__item"><a href="https://openmetal.io/resources/sales-faq/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>General Sales FAQ</span></a></li><li class="footer__item"><a href="https://openmetal.io/free-trial/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Free Trial</span></a></li><li class="footer__item"><a href="https://openmetal.io/schedule-meeting/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Schedule a Meeting</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items"><li class="footer__item"><a href="https://openmetal.io/blog/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>OpenMetal Blog</span></a></li><li class="footer__item"><a href="https://openmetal.io/resources/cloud-industry-events/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Cloud Industry Events</span></a></li><li class="footer__item"><a href="https://openmetal.io/resources/sales-faq/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Sales FAQ</span></a></li><li class="footer__item"><a href="https://central.openmetal.io/auth/sign-in" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Login to OpenMetal Central</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Documentation</div><ul class="footer__items"><li class="footer__item"><a href="https://openmetal.io/docs/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Documentation Home</span></a></li><li class="footer__item"><a href="https://openmetal.io/docs/manuals/openstack-operators/openstack-operators-manual-private-cloud-core/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>OpenStack Operator’s Manual</span></a></li><li class="footer__item"><a href="https://openmetal.io/docs/manuals/openstack-users/openstack-users-manual/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>OpenStack User’s Manual</span></a></li><li class="footer__item"><a href="https://openmetal.io/docs/product-guides/private-cloud/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Private Cloud Users</span></a></li><li class="footer__item"><a href="https://openmetal.io/docs/releases/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Product Release Updates</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Company</div><ul class="footer__items"><li class="footer__item"><a href="https://openmetal.io/company/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>About OpenMetal</span></a></li><li class="footer__item"><a href="https://openmetal.io/company/guiding-principles/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Core Guiding Principles</span></a></li><li class="footer__item"><a href="https://openmetal.io/company/contact-us/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Contact Us</span></a></li></ul></div><div class="col footer__col"><div class="footer__title">Legal</div><ul class="footer__items"><li class="footer__item"><a href="https://openmetal.io/company/legal/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Terms of Service</span></a></li><li class="footer__item"><a href="https://openmetal.io/company/legal/privacy-policy/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Privacy Policy</span></a></li><li class="footer__item"><a href="https://openmetal.io/company/legal/donotsellmypersonaldata/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Do Not Sell My Personal Data</span></a></li><li class="footer__item"><a href="https://openmetal.io/company/legal/accessibility-statement/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Accessibility Statement</span></a></li><li class="footer__item"><a href="https://openmetal.io/company/legal/legal-inquiries/" target="_self" rel="noopener noreferrer" class="footer__link-item"><span>Legal Inquiries and DMCA</span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="https://inmotionhosting.github.io/static-assets/logo/open-metal/medium.png" alt="Openmetal Logo" class="themedImage_TMUO themedImage--light_4Vu1 footer__logo"><img src="https://inmotionhosting.github.io/static-assets/logo/open-metal/medium.png" alt="Openmetal Logo" class="themedImage_TMUO themedImage--dark_uzRr footer__logo"></div><div class="footer__copyright"><strong>2022 © OpenMetal, a division of <a href="https://www.inmotionhosting.com" target="_blank" rel="noopener">InMotion Hosting</a>.  All rights reserved.</strong></div></div><div class="footerContact_lPaK"><p>555 S. Independence Blvd, Virginia Beach, VA 23452</p><div class="contactLinks_EKti"><a href="tel:+18777289664">877-7-BUY-OMI</a><a href="mailto:sales@openmetal.io">sales@openmetal.io</a><a href="https://openmetal.io/schedule-meeting/">Schedule a Demo</a></div><p><strong>OpenMetal Central:</strong> <a target="_blank" href="https://central.openmetal.io/auth/sign-in">Login</a> or <a target="_blank" href="https://central.openmetal.io/sign-up">Create New Account</a></p></div></div></footer></div>
<script src="/docs/manuals/assets/js/runtime~main.e321a580.js"></script>
<script src="/docs/manuals/assets/js/main.0b726748.js"></script>
</body>
</html>